<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedLabels  #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLists   #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards   #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">{-|
Module      : UI
Description : UI rendering functions

Provides types and functions needed to render &#955;eonard app with gi-gtk-declarative-app-simple framework.
-}</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">UI</span><span class="hs-special">(</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="UI.html#State"><span class="hs-identifier">State</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier">Event</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="UI.html#view%27"><span class="hs-identifier">view'</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier">update'</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="UI.html#initialState%27"><span class="hs-identifier">initialState'</span></a></span><span>
</span><span id="line-18"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Game.html"><span class="hs-identifier">Game</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GameConstants.html"><span class="hs-identifier">GameConstants</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="AI.html"><span class="hs-identifier">AI</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">GI.Gtk</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Gtk</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GI.Gtk.Declarative</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GI.Gtk.Declarative.App.Simple</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GI.Gtk.Declarative.Container.Grid</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">append</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Vector</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(++)</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">threadDelay</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | Default additional delay between moves in Computer VS Computer game.</span><span>
</span><span id="line-38"></span><span class="hs-comment">--   Set to 0.2 seconds</span><span>
</span><span id="line-39"></span><span class="annot"><a href="UI.html#defaultSpeed"><span class="hs-identifier hs-type">defaultSpeed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-40"></span><span id="defaultSpeed"><span class="annot"><span class="annottext">defaultSpeed :: Int
</span><a href="UI.html#defaultSpeed"><span class="hs-identifier hs-var hs-var">defaultSpeed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="annot"><a href="UI.html#minSpeed"><span class="hs-identifier hs-type">minSpeed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-44"></span><span id="minSpeed"><span class="annot"><span class="annottext">minSpeed :: Int
</span><a href="UI.html#minSpeed"><span class="hs-identifier hs-var hs-var">minSpeed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="annot"><a href="UI.html#maxSpeed"><span class="hs-identifier hs-type">maxSpeed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-48"></span><span id="maxSpeed"><span class="annot"><span class="annottext">maxSpeed :: Int
</span><a href="UI.html#maxSpeed"><span class="hs-identifier hs-var hs-var">maxSpeed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- | Type containing parameters and random generator for the MCTS AI player function. </span><span>
</span><span id="line-52"></span><span class="hs-keyword">data</span><span> </span><span id="AISetting"><span class="annot"><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-53"></span><span>    </span><span id="AISetting"><span class="annot"><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-54"></span><span>        </span><span class="hs-comment">-- | Hyperparameters for the MCTS AI player function. </span><span>
</span><span id="line-55"></span><span>        </span><span class="hs-comment">--   Set based on the chosen AI difficulty. Constant during the game.</span><span>
</span><span id="line-56"></span><span>        </span><span id="hiperparameters"><span class="annot"><span class="annottext">AISetting -&gt; Hiperparameters
</span><a href="UI.html#hiperparameters"><span class="hs-identifier hs-var hs-var">hiperparameters</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AI.html#Hiperparameters"><span class="hs-identifier hs-type">AI.Hiperparameters</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-57"></span><span>        </span><span class="hs-comment">-- | Random number generator state. Changes after every AI move.</span><span>
</span><span id="line-58"></span><span>        </span><span id="generator"><span class="annot"><span class="annottext">AISetting -&gt; StdGen
</span><a href="UI.html#generator"><span class="hs-identifier hs-var hs-var">generator</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AI.html#Generator"><span class="hs-identifier hs-type">AI.Generator</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | Application states. </span><span>
</span><span id="line-63"></span><span class="hs-comment">--   Each state corresponds to one type of window application can render and values that have to be stored in that state.</span><span>
</span><span id="line-64"></span><span class="hs-keyword">data</span><span> </span><span id="State"><span class="annot"><a href="UI.html#State"><span class="hs-identifier hs-var">State</span></a></span></span><span> </span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-comment">-- | Main menu window</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="SettingsWindow"><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-var">SettingsWindow</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-67"></span><span>        </span><span id="boardSetting"><span class="annot"><span class="annottext">State -&gt; BoardSetting
</span><a href="UI.html#boardSetting"><span class="hs-identifier hs-var hs-var">boardSetting</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#BoardSetting"><span class="hs-identifier hs-type">Game.BoardSetting</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-68"></span><span>        </span><span id="isRedComputer"><span class="annot"><span class="annottext">State -&gt; Bool
</span><a href="UI.html#isRedComputer"><span class="hs-identifier hs-var hs-var">isRedComputer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-69"></span><span>        </span><span id="redDifficulty"><span class="annot"><span class="annottext">State -&gt; Int
</span><a href="UI.html#redDifficulty"><span class="hs-identifier hs-var hs-var">redDifficulty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameConstants.html#Difficulty"><span class="hs-identifier hs-type">GameConstants.Difficulty</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-70"></span><span>        </span><span id="redSeed"><span class="annot"><span class="annottext">State -&gt; Int
</span><a href="UI.html#redSeed"><span class="hs-identifier hs-var hs-var">redSeed</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>        </span><span id="isBlueComputer"><span class="annot"><span class="annottext">State -&gt; Bool
</span><a href="UI.html#isBlueComputer"><span class="hs-identifier hs-var hs-var">isBlueComputer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-72"></span><span>        </span><span id="blueDifficulty"><span class="annot"><span class="annottext">State -&gt; Int
</span><a href="UI.html#blueDifficulty"><span class="hs-identifier hs-var hs-var">blueDifficulty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameConstants.html#Difficulty"><span class="hs-identifier hs-type">GameConstants.Difficulty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>        </span><span id="blueSeed"><span class="annot"><span class="annottext">State -&gt; Int
</span><a href="UI.html#blueSeed"><span class="hs-identifier hs-var hs-var">blueSeed</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>        </span><span id="speed"><span class="annot"><span class="annottext">State -&gt; Int
</span><a href="UI.html#speed"><span class="hs-identifier hs-var hs-var">speed</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">}</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-comment">-- | User VS User game window.</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-comment">--   Shows: game board, buttons with available moves, winner information when a player wins, &quot;Back to menu&quot; button.</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-comment">--   Users can play moves clicking corresponding buttons. After every move game board is immediately refreshed.</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="UserVSUserWindow"><span class="annot"><a href="UI.html#UserVSUserWindow"><span class="hs-identifier hs-var">UserVSUserWindow</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-79"></span><span>        </span><span id="gameState"><span class="annot"><span class="annottext">State -&gt; GameState
</span><a href="UI.html#gameState"><span class="hs-identifier hs-var hs-var">gameState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#GameState"><span class="hs-identifier hs-type">Game.GameState</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-comment">-- | User VS User game window. </span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-comment">--   Shows: game board, buttons with available moves when its Users turn, winner information when a player wins, &quot;Back to menu&quot; button.</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-comment">--   User can play moves clicking corresponding buttons. </span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-comment">--   After every move game board is immediately refreshed, then immediately Computer plays his move and board is refreshed again.</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="UserVSComputerWindow"><span class="annot"><a href="UI.html#UserVSComputerWindow"><span class="hs-identifier hs-var">UserVSComputerWindow</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-85"></span><span>        </span><span id="gameState"><span class="annot"><a href="UI.html#gameState"><span class="hs-identifier hs-var">gameState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#GameState"><span class="hs-identifier hs-type">Game.GameState</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-86"></span><span>        </span><span id="computerColor"><span class="annot"><span class="annottext">State -&gt; Player
</span><a href="UI.html#computerColor"><span class="hs-identifier hs-var hs-var">computerColor</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#Player"><span class="hs-identifier hs-type">Game.Player</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-87"></span><span>        </span><span id="computerSetting"><span class="annot"><span class="annottext">State -&gt; AISetting
</span><a href="UI.html#computerSetting"><span class="hs-identifier hs-var hs-var">computerSetting</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UI.html#AISetting"><span class="hs-identifier hs-type">AISetting</span></a></span><span class="hs-special">}</span><span> </span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-comment">-- | Computer VS Computer game window. Also called Simulation. </span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-comment">--   Shows: game board, &quot;Pause&quot;/&quot;Resume&quot; button, winner information when a player wins, &quot;Back to menu&quot; button.</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-comment">--   Computer players play moves alternately. There is added a fixed delay 'speed' between the moves. Immediately after every move the board is refreshed.</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-comment">--   Simulation can be paused and resumed any time.</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ComputerVSComputerWindow"><span class="annot"><a href="UI.html#ComputerVSComputerWindow"><span class="hs-identifier hs-var">ComputerVSComputerWindow</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-93"></span><span>        </span><span id="gameState"><span class="annot"><a href="UI.html#gameState"><span class="hs-identifier hs-var">gameState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#GameState"><span class="hs-identifier hs-type">Game.GameState</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-94"></span><span>        </span><span id="red"><span class="annot"><span class="annottext">State -&gt; AISetting
</span><a href="UI.html#red"><span class="hs-identifier hs-var hs-var">red</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UI.html#AISetting"><span class="hs-identifier hs-type">AISetting</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-95"></span><span>        </span><span id="blue"><span class="annot"><span class="annottext">State -&gt; AISetting
</span><a href="UI.html#blue"><span class="hs-identifier hs-var hs-var">blue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UI.html#AISetting"><span class="hs-identifier hs-type">AISetting</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-96"></span><span>        </span><span id="speed"><span class="annot"><a href="UI.html#speed"><span class="hs-identifier hs-var">speed</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-97"></span><span>        </span><span id="paused"><span class="annot"><span class="annottext">State -&gt; Bool
</span><a href="UI.html#paused"><span class="hs-identifier hs-var hs-var">paused</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">}</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">-- | Error window containing single error message.</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-comment">--   State should not be reachable in the application.</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ErrorWindow"><span class="annot"><a href="UI.html#ErrorWindow"><span class="hs-identifier hs-var">ErrorWindow</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-101"></span><span>        </span><span id="message"><span class="annot"><span class="annottext">State -&gt; Text
</span><a href="UI.html#message"><span class="hs-identifier hs-var hs-var">message</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">}</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Possible events. Each event depending on current state changes state and then does some IO action and finally maybe invokes other events.</span><span>
</span><span id="line-105"></span><span class="hs-keyword">data</span><span> </span><span id="Event"><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-var">Event</span></a></span></span><span> </span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Closed"><span class="annot"><a href="UI.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span></span><span> </span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Error"><span class="annot"><a href="UI.html#Error"><span class="hs-identifier hs-var">Error</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-comment">-- | Settings modification events: (Evoked every time value is changed in the SettingsWindow) </span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-comment">--   Each *Changed event is parametrized by the new value setting should take</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="MChanged"><span class="annot"><a href="UI.html#MChanged"><span class="hs-identifier hs-var">MChanged</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="NChanged"><span class="annot"><a href="UI.html#NChanged"><span class="hs-identifier hs-var">NChanged</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KChanged"><span class="annot"><a href="UI.html#KChanged"><span class="hs-identifier hs-var">KChanged</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="RedTypeChanged"><span class="annot"><a href="UI.html#RedTypeChanged"><span class="hs-identifier hs-var">RedTypeChanged</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="BlueTypeChanged"><span class="annot"><a href="UI.html#BlueTypeChanged"><span class="hs-identifier hs-var">BlueTypeChanged</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="RedDifficultyChanged"><span class="annot"><a href="UI.html#RedDifficultyChanged"><span class="hs-identifier hs-var">RedDifficultyChanged</span></a></span></span><span> </span><span class="annot"><a href="GameConstants.html#Difficulty"><span class="hs-identifier hs-type">GameConstants.Difficulty</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="BlueDifficultyChanged"><span class="annot"><a href="UI.html#BlueDifficultyChanged"><span class="hs-identifier hs-var">BlueDifficultyChanged</span></a></span></span><span> </span><span class="annot"><a href="GameConstants.html#Difficulty"><span class="hs-identifier hs-type">GameConstants.Difficulty</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="RedSeedChanged"><span class="annot"><a href="UI.html#RedSeedChanged"><span class="hs-identifier hs-var">RedSeedChanged</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="BlueSeedChanged"><span class="annot"><a href="UI.html#BlueSeedChanged"><span class="hs-identifier hs-var">BlueSeedChanged</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SpeedChanged"><span class="annot"><a href="UI.html#SpeedChanged"><span class="hs-identifier hs-var">SpeedChanged</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="StartGame"><span class="annot"><a href="UI.html#StartGame"><span class="hs-identifier hs-var">StartGame</span></a></span></span><span> </span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-comment">-- | Game events: </span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-comment">--   Should appear only in one of the game windows</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="EndGame"><span class="annot"><a href="UI.html#EndGame"><span class="hs-identifier hs-var">EndGame</span></a></span></span><span> </span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="MovePlayed"><span class="annot"><a href="UI.html#MovePlayed"><span class="hs-identifier hs-var">MovePlayed</span></a></span></span><span> </span><span class="annot"><a href="Game.html#Move"><span class="hs-identifier hs-type">Game.Move</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SimulationPaused"><span class="annot"><a href="UI.html#SimulationPaused"><span class="hs-identifier hs-var">SimulationPaused</span></a></span></span><span> </span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SimulationResumed"><span class="annot"><a href="UI.html#SimulationResumed"><span class="hs-identifier hs-var">SimulationResumed</span></a></span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Default values of SettingsWindow State</span><span>
</span><span id="line-130"></span><span class="annot"><a href="UI.html#defaultSettingsWindow"><span class="hs-identifier hs-type">defaultSettingsWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UI.html#State"><span class="hs-identifier hs-type">State</span></a></span><span>
</span><span id="line-131"></span><span id="defaultSettingsWindow"><span class="annot"><span class="annottext">defaultSettingsWindow :: State
</span><a href="UI.html#defaultSettingsWindow"><span class="hs-identifier hs-var hs-var">defaultSettingsWindow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BoardSetting
-&gt; Bool -&gt; Int -&gt; Int -&gt; Bool -&gt; Int -&gt; Int -&gt; Int -&gt; State
</span><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-var">SettingsWindow</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><a href="GameConstants.html#defaultBoardSetting"><span class="hs-identifier hs-var">GameConstants.defaultBoardSetting</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GameConstants.html#defaultDifficulty"><span class="hs-identifier hs-var">GameConstants.defaultDifficulty</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">137</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GameConstants.html#defaultDifficulty"><span class="hs-identifier hs-var">GameConstants.defaultDifficulty</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">213</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="UI.html#defaultSpeed"><span class="hs-identifier hs-var">defaultSpeed</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | Window containing whole application</span><span>
</span><span id="line-135"></span><span class="annot"><a href="UI.html#mainWrapper"><span class="hs-identifier hs-type">mainWrapper</span></a></span><span> </span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Widget</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="hs-comment">-- ^ Content of the window. Single widget, usually a Box containing all the children.</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AppView</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gtk.Window</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span>
</span><span id="line-138"></span><span id="mainWrapper"><span class="annot"><span class="annottext">mainWrapper :: Widget Event -&gt; AppView Window Event
</span><a href="UI.html#mainWrapper"><span class="hs-identifier hs-var hs-var">mainWrapper</span></a></span></span><span> </span><span id="local-6989586621679211802"><span class="annot"><span class="annottext">Widget Event
</span><a href="#local-6989586621679211802"><span class="hs-identifier hs-var">child</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ManagedPtr Window -&gt; Window)
-&gt; Vector (Attribute Window Event)
-&gt; Widget Event
-&gt; AppView Window Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsContainer widget, IsBin widget,
 IsWidget widget, FromWidget (Bin widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; Widget event -&gt; target event
</span><span class="hs-identifier hs-var">bin</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Window -&gt; Window
</span><span class="hs-identifier hs-var">Gtk.Window</span></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;title&quot; (AttrLabelProxy &quot;title&quot;)
AttrLabelProxy &quot;title&quot;
</span><a href="#local-6989586621679214249"><span class="hs-var">#title</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;title&quot; -&gt; Text -&gt; Attribute Window Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&#955;eonard&quot;</span></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="annottext">SignalProxy Window WidgetDeleteEventSignalInfo
-&gt; (Event -&gt; (Bool, Event)) -&gt; Attribute Window Event
forall widget info gtkCallback userEventHandler event.
(GObject widget, SignalInfo info,
 gtkCallback ~ HaskellCallbackType info,
 ToGtkCallback gtkCallback 'Pure,
 ToEventHandler gtkCallback widget 'Pure,
 userEventHandler
 ~ UserEventHandler gtkCallback widget 'Pure event) =&gt;
SignalProxy widget info
-&gt; userEventHandler -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;deleteEvent&quot; (SignalProxy Window WidgetDeleteEventSignalInfo)
SignalProxy Window WidgetDeleteEventSignalInfo
</span><a href="#local-6989586621679214233"><span class="hs-var">#deleteEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool, Event) -&gt; Event -&gt; (Bool, Event)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="UI.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-cpp"> 
  #resizable := False
</span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><span class="annottext">(Widget Event -&gt; AppView Window Event)
-&gt; Widget Event -&gt; AppView Window Event
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Widget Event
</span><a href="#local-6989586621679211802"><span class="hs-identifier hs-var">child</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Button with &quot;+&quot; label evoking Int parametrized event modyfing a variable. </span><span>
</span><span id="line-147"></span><span class="hs-comment">--   Inactive when value of a given variable would exceed given bound.</span><span>
</span><span id="line-148"></span><span class="annot"><a href="UI.html#plusButton"><span class="hs-identifier hs-type">plusButton</span></a></span><span> </span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ 'currVal' - Current value of the variable button modifies</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Max value of the variable button modifies</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ 'event' - Function for a given 'val' Int returning event modyfing the variable to a 'val' value.</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BoxChild</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="hs-comment">-- ^ Resulting Button widget. Clicking button evokes 'event (currVal + 1)'</span><span>
</span><span id="line-153"></span><span id="plusButton"><span class="annot"><span class="annottext">plusButton :: Int -&gt; Int -&gt; (Int -&gt; Event) -&gt; BoxChild Event
</span><a href="UI.html#plusButton"><span class="hs-identifier hs-var hs-var">plusButton</span></a></span></span><span> </span><span id="local-6989586621679211795"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211795"><span class="hs-identifier hs-var">currVal</span></a></span></span><span> </span><span id="local-6989586621679211794"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211794"><span class="hs-identifier hs-var">maxVal</span></a></span></span><span> </span><span id="local-6989586621679211793"><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="#local-6989586621679211793"><span class="hs-identifier hs-var">event</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><span class="annottext">(ManagedPtr Button -&gt; Button)
-&gt; Vector (Attribute Button Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Button -&gt; Button
</span><span class="hs-identifier hs-var">Gtk.Button</span></span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
        #label := &quot;+&quot;, 
</span><span>        </span><span class="annot"><span class="annottext">SignalProxy Button ButtonClickedSignalInfo
-&gt; Event -&gt; Attribute Button Event
forall widget info gtkCallback userEventHandler event.
(GObject widget, SignalInfo info,
 gtkCallback ~ HaskellCallbackType info,
 ToGtkCallback gtkCallback 'Pure,
 ToEventHandler gtkCallback widget 'Pure,
 userEventHandler
 ~ UserEventHandler gtkCallback widget 'Pure event) =&gt;
SignalProxy widget info
-&gt; userEventHandler -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;clicked&quot; (SignalProxy Button ButtonClickedSignalInfo)
SignalProxy Button ButtonClickedSignalInfo
</span><a href="#local-6989586621679214292"><span class="hs-var">#clicked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="#local-6989586621679211793"><span class="hs-identifier hs-var">event</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211795"><span class="hs-identifier hs-var">currVal</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-cpp"> 
        #sensitive := (currVal &lt; maxVal)
</span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- | Button with &quot;-&quot; label evoking Int parametrized event modyfing a variable. </span><span>
</span><span id="line-161"></span><span class="hs-comment">--   Inactive when value of a given variable would exceed given bound.</span><span>
</span><span id="line-162"></span><span class="annot"><a href="UI.html#minusButton"><span class="hs-identifier hs-type">minusButton</span></a></span><span> </span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ 'currVal' - Current value of the variable button modifies</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Min value of the variable button modifies</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ 'event' - Function for a given 'val' Int returning event modyfing the variable to a 'val' value.</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BoxChild</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="hs-comment">-- ^ Resulting Button widget. Clicking button evokes 'event (currVal - 1)'</span><span>
</span><span id="line-167"></span><span id="minusButton"><span class="annot"><span class="annottext">minusButton :: Int -&gt; Int -&gt; (Int -&gt; Event) -&gt; BoxChild Event
</span><a href="UI.html#minusButton"><span class="hs-identifier hs-var hs-var">minusButton</span></a></span></span><span> </span><span id="local-6989586621679211787"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211787"><span class="hs-identifier hs-var">currVal</span></a></span></span><span> </span><span id="local-6989586621679211786"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211786"><span class="hs-identifier hs-var">minVal</span></a></span></span><span> </span><span id="local-6989586621679211785"><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="#local-6989586621679211785"><span class="hs-identifier hs-var">event</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="annottext">(ManagedPtr Button -&gt; Button)
-&gt; Vector (Attribute Button Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Button -&gt; Button
</span><span class="hs-identifier hs-var">Gtk.Button</span></span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
        #label := &quot;-&quot;, 
</span><span>        </span><span class="annot"><span class="annottext">SignalProxy Button ButtonClickedSignalInfo
-&gt; Event -&gt; Attribute Button Event
forall widget info gtkCallback userEventHandler event.
(GObject widget, SignalInfo info,
 gtkCallback ~ HaskellCallbackType info,
 ToGtkCallback gtkCallback 'Pure,
 ToEventHandler gtkCallback widget 'Pure,
 userEventHandler
 ~ UserEventHandler gtkCallback widget 'Pure event) =&gt;
SignalProxy widget info
-&gt; userEventHandler -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;clicked&quot; (SignalProxy Button ButtonClickedSignalInfo)
SignalProxy Button ButtonClickedSignalInfo
</span><a href="#local-6989586621679214340"><span class="hs-var">#clicked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="#local-6989586621679211785"><span class="hs-identifier hs-var">event</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211787"><span class="hs-identifier hs-var">currVal</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-cpp"> 
        #sensitive := (currVal &gt; minVal)
</span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Map board field value to an appropiate image representing token or empty field</span><span>
</span><span id="line-176"></span><span class="annot"><a href="UI.html#boardElemToImage"><span class="hs-identifier hs-type">boardElemToImage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Game.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Widget</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span>
</span><span id="line-177"></span><span id="boardElemToImage"><span class="annot"><span class="annottext">boardElemToImage :: Maybe Player -&gt; Widget Event
</span><a href="UI.html#boardElemToImage"><span class="hs-identifier hs-var hs-var">boardElemToImage</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Player
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ManagedPtr Image -&gt; Image)
-&gt; Vector (Attribute Image Event) -&gt; Widget Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Image -&gt; Image
</span><span class="hs-identifier hs-var">Gtk.Image</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;file&quot; (AttrLabelProxy &quot;file&quot;)
AttrLabelProxy &quot;file&quot;
</span><a href="#local-6989586621679214464"><span class="hs-var">#file</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;file&quot; -&gt; Text -&gt; Attribute Image Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;img/empty.png&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-178"></span><span class="annot"><a href="UI.html#boardElemToImage"><span class="hs-identifier hs-var">boardElemToImage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="Game.html#Red"><span class="hs-identifier hs-var">Red</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ManagedPtr Image -&gt; Image)
-&gt; Vector (Attribute Image Event) -&gt; Widget Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Image -&gt; Image
</span><span class="hs-identifier hs-var">Gtk.Image</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;file&quot; (AttrLabelProxy &quot;file&quot;)
AttrLabelProxy &quot;file&quot;
</span><a href="#local-6989586621679214445"><span class="hs-var">#file</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;file&quot; -&gt; Text -&gt; Attribute Image Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;img/red.png&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span class="annot"><a href="UI.html#boardElemToImage"><span class="hs-identifier hs-var">boardElemToImage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="Game.html#Blue"><span class="hs-identifier hs-var">Blue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ManagedPtr Image -&gt; Image)
-&gt; Vector (Attribute Image Event) -&gt; Widget Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Image -&gt; Image
</span><span class="hs-identifier hs-var">Gtk.Image</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;file&quot; (AttrLabelProxy &quot;file&quot;)
AttrLabelProxy &quot;file&quot;
</span><a href="#local-6989586621679214426"><span class="hs-var">#file</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;file&quot; -&gt; Text -&gt; Attribute Image Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;img/blue.png&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- | Map a board field to a Grid child containing image representing appropiate token or empty field</span><span>
</span><span id="line-183"></span><span class="annot"><a href="UI.html#boardElemToGridChild"><span class="hs-identifier hs-type">boardElemToGridChild</span></a></span><span> </span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ number of rows</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ index of the field in the BoardState Sequence</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Game.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-comment">-- ^ value of the field in the BoardState Sequence</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GridChild</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="hs-comment">-- ^ resulting Grid child</span><span>
</span><span id="line-188"></span><span id="boardElemToGridChild"><span class="annot"><span class="annottext">boardElemToGridChild :: Int -&gt; Int -&gt; Maybe Player -&gt; GridChild Event
</span><a href="UI.html#boardElemToGridChild"><span class="hs-identifier hs-var hs-var">boardElemToGridChild</span></a></span></span><span> </span><span id="local-6989586621679211778"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211778"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679211777"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211777"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679211776"><span class="annot"><span class="annottext">Maybe Player
</span><a href="#local-6989586621679211776"><span class="hs-identifier hs-var">elem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GridChild :: forall event.
GridChildProperties -&gt; Widget event -&gt; GridChild event
</span><span class="hs-identifier hs-type">GridChild</span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">properties :: GridChildProperties
</span><span class="hs-identifier hs-var">properties</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GridChildProperties
</span><span class="hs-identifier hs-var">defaultGridChildProperties</span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><span class="annottext">width :: Int32
</span><span class="hs-identifier hs-var">width</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">height :: Int32
</span><span class="hs-identifier hs-var">height</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="annottext">leftAttach :: Int32
</span><span class="hs-identifier hs-var">leftAttach</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211777"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211778"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><span class="annottext">topAttach :: Int32
</span><span class="hs-identifier hs-var">topAttach</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211778"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211777"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211778"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int32 -&gt; Int32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">1</span></span><span>
</span><span id="line-193"></span><span>        </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">child :: Widget Event
</span><span class="hs-identifier hs-var">child</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Player -&gt; Widget Event
</span><a href="UI.html#boardElemToImage"><span class="hs-identifier hs-var">boardElemToImage</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Player
</span><a href="#local-6989586621679211776"><span class="hs-identifier hs-var">elem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span class="hs-special">}</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | Map board state to Vector of Grid children containing images representing appropiate tokens or empty fields</span><span>
</span><span id="line-199"></span><span class="annot"><a href="UI.html#boardToGridChildren"><span class="hs-identifier hs-type">boardToGridChildren</span></a></span><span> </span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ number of rows</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.html#BoardState"><span class="hs-identifier hs-type">BoardState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GridChild</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span id="boardToGridChildren"><span class="annot"><span class="annottext">boardToGridChildren :: Int -&gt; BoardState -&gt; Vector (GridChild Event)
</span><a href="UI.html#boardToGridChildren"><span class="hs-identifier hs-var hs-var">boardToGridChildren</span></a></span></span><span> </span><span id="local-6989586621679211764"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211764"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679211763"><span class="annot"><span class="annottext">BoardState
</span><a href="#local-6989586621679211763"><span class="hs-identifier hs-var">board</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GridChild Event] -&gt; Vector (GridChild Event)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (GridChild Event) -&gt; [GridChild Event]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Maybe Player -&gt; GridChild Event)
-&gt; BoardState -&gt; Seq (GridChild Event)
forall a b. (Int -&gt; a -&gt; b) -&gt; Seq a -&gt; Seq b
</span><span class="hs-identifier hs-var">Seq.mapWithIndex</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Maybe Player -&gt; GridChild Event
</span><a href="UI.html#boardElemToGridChild"><span class="hs-identifier hs-var">boardElemToGridChild</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211764"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BoardState
</span><a href="#local-6989586621679211763"><span class="hs-identifier hs-var">board</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- | Map a single move to a button. Clicking that button will evoke 'MovePlayed' event.</span><span>
</span><span id="line-206"></span><span class="annot"><a href="UI.html#moveToButton"><span class="hs-identifier hs-type">moveToButton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Widget</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span>
</span><span id="line-207"></span><span id="moveToButton"><span class="annot"><span class="annottext">moveToButton :: Player -&gt; Int -&gt; Widget Event
</span><a href="UI.html#moveToButton"><span class="hs-identifier hs-var hs-var">moveToButton</span></a></span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="Game.html#Red"><span class="hs-identifier hs-var">Red</span></a></span><span> </span><span id="local-6989586621679211760"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211760"><span class="hs-identifier hs-var">move</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ManagedPtr Button -&gt; Button)
-&gt; Vector (Attribute Button Event) -&gt; Widget Event -&gt; Widget Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsContainer widget, IsBin widget,
 IsWidget widget, FromWidget (Bin widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; Widget event -&gt; target event
</span><span class="hs-identifier hs-var">bin</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Button -&gt; Button
</span><span class="hs-identifier hs-var">Gtk.Button</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SignalProxy Button ButtonClickedSignalInfo
-&gt; Event -&gt; Attribute Button Event
forall widget info gtkCallback userEventHandler event.
(GObject widget, SignalInfo info,
 gtkCallback ~ HaskellCallbackType info,
 ToGtkCallback gtkCallback 'Pure,
 ToEventHandler gtkCallback widget 'Pure,
 userEventHandler
 ~ UserEventHandler gtkCallback widget 'Pure event) =&gt;
SignalProxy widget info
-&gt; userEventHandler -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;clicked&quot; (SignalProxy Button ButtonClickedSignalInfo)
SignalProxy Button ButtonClickedSignalInfo
</span><a href="#local-6989586621679214578"><span class="hs-var">#clicked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#MovePlayed"><span class="hs-identifier hs-var">MovePlayed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211760"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;margin&quot; (AttrLabelProxy &quot;margin&quot;)
AttrLabelProxy &quot;margin&quot;
</span><a href="#local-6989586621679214564"><span class="hs-var">#margin</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;margin&quot; -&gt; Int32 -&gt; Attribute Button Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ManagedPtr Image -&gt; Image)
-&gt; Vector (Attribute Image Event) -&gt; Widget Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Image -&gt; Image
</span><span class="hs-identifier hs-var">Gtk.Image</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;file&quot; (AttrLabelProxy &quot;file&quot;)
AttrLabelProxy &quot;file&quot;
</span><a href="#local-6989586621679214539"><span class="hs-var">#file</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;file&quot; -&gt; Text -&gt; Attribute Image Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;img/redArrow.png&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span class="annot"><a href="UI.html#moveToButton"><span class="hs-identifier hs-var">moveToButton</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="Game.html#Blue"><span class="hs-identifier hs-var">Blue</span></a></span><span> </span><span id="local-6989586621679211759"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211759"><span class="hs-identifier hs-var">move</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ManagedPtr Button -&gt; Button)
-&gt; Vector (Attribute Button Event) -&gt; Widget Event -&gt; Widget Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsContainer widget, IsBin widget,
 IsWidget widget, FromWidget (Bin widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; Widget event -&gt; target event
</span><span class="hs-identifier hs-var">bin</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Button -&gt; Button
</span><span class="hs-identifier hs-var">Gtk.Button</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SignalProxy Button ButtonClickedSignalInfo
-&gt; Event -&gt; Attribute Button Event
forall widget info gtkCallback userEventHandler event.
(GObject widget, SignalInfo info,
 gtkCallback ~ HaskellCallbackType info,
 ToGtkCallback gtkCallback 'Pure,
 ToEventHandler gtkCallback widget 'Pure,
 userEventHandler
 ~ UserEventHandler gtkCallback widget 'Pure event) =&gt;
SignalProxy widget info
-&gt; userEventHandler -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;clicked&quot; (SignalProxy Button ButtonClickedSignalInfo)
SignalProxy Button ButtonClickedSignalInfo
</span><a href="#local-6989586621679214522"><span class="hs-var">#clicked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#MovePlayed"><span class="hs-identifier hs-var">MovePlayed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211759"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;margin&quot; (AttrLabelProxy &quot;margin&quot;)
AttrLabelProxy &quot;margin&quot;
</span><a href="#local-6989586621679214508"><span class="hs-var">#margin</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;margin&quot; -&gt; Int32 -&gt; Attribute Button Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ManagedPtr Image -&gt; Image)
-&gt; Vector (Attribute Image Event) -&gt; Widget Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Image -&gt; Image
</span><span class="hs-identifier hs-var">Gtk.Image</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;file&quot; (AttrLabelProxy &quot;file&quot;)
AttrLabelProxy &quot;file&quot;
</span><a href="#local-6989586621679214489"><span class="hs-var">#file</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;file&quot; -&gt; Text -&gt; Attribute Image Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;img/blueArrow.png&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- | Map a single move to Grid element containing move button</span><span>
</span><span id="line-212"></span><span class="annot"><a href="UI.html#moveToGridChild"><span class="hs-identifier hs-type">moveToGridChild</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GridChild</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span>
</span><span id="line-213"></span><span id="moveToGridChild"><span class="annot"><span class="annottext">moveToGridChild :: Player -&gt; Int -&gt; GridChild Event
</span><a href="UI.html#moveToGridChild"><span class="hs-identifier hs-var hs-var">moveToGridChild</span></a></span></span><span> </span><span id="local-6989586621679211757"><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211757"><span class="hs-identifier hs-var">player</span></a></span></span><span> </span><span id="local-6989586621679211756"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211756"><span class="hs-identifier hs-var">move</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GridChild :: forall event.
GridChildProperties -&gt; Widget event -&gt; GridChild event
</span><span class="hs-identifier hs-type">GridChild</span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">properties :: GridChildProperties
</span><span class="hs-identifier hs-var">properties</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GridChildProperties
</span><span class="hs-identifier hs-var">defaultGridChildProperties</span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="annottext">width :: Int32
</span><span class="hs-identifier hs-var">width</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">height :: Int32
</span><span class="hs-identifier hs-var">height</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">leftAttach :: Int32
</span><span class="hs-identifier hs-var">leftAttach</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211756"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="annottext">topAttach :: Int32
</span><span class="hs-identifier hs-var">topAttach</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-218"></span><span>        </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="annottext">child :: Widget Event
</span><span class="hs-identifier hs-var">child</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Int -&gt; Widget Event
</span><a href="UI.html#moveToButton"><span class="hs-identifier hs-var">moveToButton</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211757"><span class="hs-identifier hs-var">player</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211756"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span class="hs-special">}</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | Map moves to Grid elements containing move buttons</span><span>
</span><span id="line-224"></span><span class="annot"><a href="UI.html#movesToGridChildren"><span class="hs-identifier hs-type">movesToGridChildren</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GridChild</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span id="movesToGridChildren"><span class="annot"><span class="annottext">movesToGridChildren :: Player -&gt; [Int] -&gt; Vector (GridChild Event)
</span><a href="UI.html#movesToGridChildren"><span class="hs-identifier hs-var hs-var">movesToGridChildren</span></a></span></span><span> </span><span id="local-6989586621679211754"><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211754"><span class="hs-identifier hs-var">player</span></a></span></span><span> </span><span id="local-6989586621679211753"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679211753"><span class="hs-identifier hs-var">moves</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GridChild Event] -&gt; Vector (GridChild Event)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; GridChild Event) -&gt; [Int] -&gt; [GridChild Event]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Int -&gt; GridChild Event
</span><a href="UI.html#moveToGridChild"><span class="hs-identifier hs-var">moveToGridChild</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211754"><span class="hs-identifier hs-var">player</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679211753"><span class="hs-identifier hs-var">moves</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Map game state to Grid widget</span><span>
</span><span id="line-229"></span><span class="annot"><a href="UI.html#gameGrid"><span class="hs-identifier hs-type">gameGrid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^ Whether to show move buttons at the top of the grid. Buttons should be shown only if it's Users turn. </span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BoxChild</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span>
</span><span id="line-232"></span><span id="gameGrid"><span class="annot"><span class="annottext">gameGrid :: GameState -&gt; Bool -&gt; BoxChild Event
</span><a href="UI.html#gameGrid"><span class="hs-identifier hs-var hs-var">gameGrid</span></a></span></span><span> </span><span id="local-6989586621679211751"><span class="annot"><span class="annottext">gameState :: GameState
</span><a href="#local-6989586621679211751"><span class="hs-identifier hs-var">gameState</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Game.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span id="local-6989586621679211749"><span class="annot"><span class="annottext">bs :: BoardSetting
</span><a href="#local-6989586621679211749"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Game.html#BoardSetting"><span class="hs-identifier hs-type">BoardSetting</span></a></span><span> </span><span id="local-6989586621679211747"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211747"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679211746"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211746"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679211745"><span class="annot"><span class="annottext">BoardState
</span><a href="#local-6989586621679211745"><span class="hs-identifier hs-var">board</span></a></span></span><span> </span><span id="local-6989586621679211744"><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211744"><span class="hs-identifier hs-var">player</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679211743"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211743"><span class="hs-identifier hs-var">showMoves</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ManagedPtr Grid -&gt; Grid)
-&gt; Vector (Attribute Grid Event)
-&gt; Vector (GridChild Event)
-&gt; BoxChild Event
forall widget (child :: * -&gt; *) (target :: * -&gt; *)
       (parent :: * -&gt; *) event.
(Typeable widget, Functor child, IsWidget widget,
 IsContainer widget,
 FromWidget (Container widget (Children child)) target,
 ToChildren widget parent child) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event)
-&gt; parent (child event)
-&gt; target event
</span><span class="hs-identifier hs-var">container</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Grid -&gt; Grid
</span><span class="hs-identifier hs-var">Gtk.Grid</span></span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
    #rowSpacing := 0,
</span><span class="hs-cpp">    #columnSpacing := 0
</span><span>    </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Vector (GridChild Event)
</span><a href="#local-6989586621679211740"><span class="hs-identifier hs-var">gridElements</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-236"></span><span>        </span><span id="local-6989586621679211740"><span class="annot"><span class="annottext">gridElements :: Vector (GridChild Event)
</span><a href="#local-6989586621679211740"><span class="hs-identifier hs-var hs-var">gridElements</span></a></span></span><span>
</span><span id="line-237"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211743"><span class="hs-identifier hs-var">showMoves</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; BoardState -&gt; Vector (GridChild Event)
</span><a href="UI.html#boardToGridChildren"><span class="hs-identifier hs-var">boardToGridChildren</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211747"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">BoardState
</span><a href="#local-6989586621679211745"><span class="hs-identifier hs-var">board</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (GridChild Event)
-&gt; Vector (GridChild Event) -&gt; Vector (GridChild Event)
forall a. Vector a -&gt; Vector a -&gt; Vector a
</span><span class="hs-operator hs-var">Data.Vector.++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; [Int] -&gt; Vector (GridChild Event)
</span><a href="UI.html#movesToGridChildren"><span class="hs-identifier hs-var">movesToGridChildren</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211744"><span class="hs-identifier hs-var">player</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; [Int]
</span><a href="Game.html#availableMoves"><span class="hs-identifier hs-var">Game.availableMoves</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211751"><span class="hs-identifier hs-var">gameState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; BoardState -&gt; Vector (GridChild Event)
</span><a href="UI.html#boardToGridChildren"><span class="hs-identifier hs-var">boardToGridChildren</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211747"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">BoardState
</span><a href="#local-6989586621679211745"><span class="hs-identifier hs-var">board</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | Content of win information box in game window.</span><span>
</span><span id="line-242"></span><span class="hs-comment">--   For Nothing returns empty vector</span><span>
</span><span id="line-243"></span><span class="hs-comment">--   For Just Player returns vector with single label saying, that given player wins</span><span>
</span><span id="line-244"></span><span class="annot"><a href="UI.html#winInformation"><span class="hs-identifier hs-type">winInformation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Game.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BoxChild</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span id="winInformation"><span class="annot"><span class="annottext">winInformation :: Maybe Player -&gt; Vector (BoxChild Event)
</span><a href="UI.html#winInformation"><span class="hs-identifier hs-var hs-var">winInformation</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Player
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-246"></span><span class="annot"><a href="UI.html#winInformation"><span class="hs-identifier hs-var">winInformation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="Game.html#Blue"><span class="hs-identifier hs-var">Blue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679214665"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Blue player wins!&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;marginTop&quot; (AttrLabelProxy &quot;marginTop&quot;)
AttrLabelProxy &quot;marginTop&quot;
</span><a href="#local-6989586621679214649"><span class="hs-var">#marginTop</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;marginTop&quot; -&gt; Int32 -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Attribute Label Event
forall widget event.
IsWidget widget =&gt;
[Text] -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">classes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item [Text]
</span><span class="hs-string">&quot;winInformation&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Item [Text]
</span><span class="hs-string">&quot;blue&quot;</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-247"></span><span class="annot"><a href="UI.html#winInformation"><span class="hs-identifier hs-var">winInformation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="Game.html#Red"><span class="hs-identifier hs-var">Red</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679214623"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Red player wins!&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;marginTop&quot; (AttrLabelProxy &quot;marginTop&quot;)
AttrLabelProxy &quot;marginTop&quot;
</span><a href="#local-6989586621679214608"><span class="hs-var">#marginTop</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;marginTop&quot; -&gt; Int32 -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Attribute Label Event
forall widget event.
IsWidget widget =&gt;
[Text] -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">classes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item [Text]
</span><span class="hs-string">&quot;winInformation&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Item [Text]
</span><span class="hs-string">&quot;red&quot;</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- | Content of pause button box in game window.</span><span>
</span><span id="line-251"></span><span class="hs-comment">--   For Nothing returns empty vector</span><span>
</span><span id="line-252"></span><span class="hs-comment">--   For Just True returns vector with single &quot;Resume&quot; button</span><span>
</span><span id="line-253"></span><span class="hs-comment">--   For Just False returns vector with single &quot;Pause&quot; button</span><span>
</span><span id="line-254"></span><span class="annot"><a href="UI.html#pauseButton"><span class="hs-identifier hs-type">pauseButton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BoxChild</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span id="pauseButton"><span class="annot"><span class="annottext">pauseButton :: Maybe Bool -&gt; Vector (BoxChild Event)
</span><a href="UI.html#pauseButton"><span class="hs-identifier hs-var hs-var">pauseButton</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-256"></span><span class="annot"><a href="UI.html#pauseButton"><span class="hs-identifier hs-var">pauseButton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(ManagedPtr Button -&gt; Button)
-&gt; Vector (Attribute Button Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Button -&gt; Button
</span><span class="hs-identifier hs-var">Gtk.Button</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679214735"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Button Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Resume&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SignalProxy Button ButtonClickedSignalInfo
-&gt; Event -&gt; Attribute Button Event
forall widget info gtkCallback userEventHandler event.
(GObject widget, SignalInfo info,
 gtkCallback ~ HaskellCallbackType info,
 ToGtkCallback gtkCallback 'Pure,
 ToEventHandler gtkCallback widget 'Pure,
 userEventHandler
 ~ UserEventHandler gtkCallback widget 'Pure event) =&gt;
SignalProxy widget info
-&gt; userEventHandler -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;clicked&quot; (SignalProxy Button ButtonClickedSignalInfo)
SignalProxy Button ButtonClickedSignalInfo
</span><a href="#local-6989586621679214719"><span class="hs-var">#clicked</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="UI.html#SimulationResumed"><span class="hs-identifier hs-var">SimulationResumed</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-257"></span><span class="annot"><a href="UI.html#pauseButton"><span class="hs-identifier hs-var">pauseButton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(ManagedPtr Button -&gt; Button)
-&gt; Vector (Attribute Button Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Button -&gt; Button
</span><span class="hs-identifier hs-var">Gtk.Button</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679214699"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Button Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Pause&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SignalProxy Button ButtonClickedSignalInfo
-&gt; Event -&gt; Attribute Button Event
forall widget info gtkCallback userEventHandler event.
(GObject widget, SignalInfo info,
 gtkCallback ~ HaskellCallbackType info,
 ToGtkCallback gtkCallback 'Pure,
 ToEventHandler gtkCallback widget 'Pure,
 userEventHandler
 ~ UserEventHandler gtkCallback widget 'Pure event) =&gt;
SignalProxy widget info
-&gt; userEventHandler -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;clicked&quot; (SignalProxy Button ButtonClickedSignalInfo)
SignalProxy Button ButtonClickedSignalInfo
</span><a href="#local-6989586621679214688"><span class="hs-var">#clicked</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="UI.html#SimulationPaused"><span class="hs-identifier hs-var">SimulationPaused</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-comment">-- | Returns a render of game window. </span><span>
</span><span id="line-261"></span><span class="annot"><a href="UI.html#gameWindow"><span class="hs-identifier hs-type">gameWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^ Whether to show buttons with possible moves, that allow user to play that moves (should be true only if user has turn)</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Game.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-comment">-- ^ Information about current winner. When Just player info about winner is displayed.</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^ When 'Just paused' (in AI VS AI games) shows pause/resume button. When Nothing does not show that button.</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AppView</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gtk.Window</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span>
</span><span id="line-266"></span><span id="gameWindow"><span class="annot"><span class="annottext">gameWindow :: GameState
-&gt; Bool -&gt; Maybe Player -&gt; Maybe Bool -&gt; AppView Window Event
</span><a href="UI.html#gameWindow"><span class="hs-identifier hs-var hs-var">gameWindow</span></a></span></span><span> </span><span id="local-6989586621679211733"><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211733"><span class="hs-identifier hs-var">gameState</span></a></span></span><span> </span><span id="local-6989586621679211732"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211732"><span class="hs-identifier hs-var">showMoves</span></a></span></span><span> </span><span id="local-6989586621679211731"><span class="annot"><span class="annottext">Maybe Player
</span><a href="#local-6989586621679211731"><span class="hs-identifier hs-var">winningPlayer</span></a></span></span><span> </span><span id="local-6989586621679211730"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679211730"><span class="hs-identifier hs-var">maybePaused</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Widget Event -&gt; AppView Window Event
</span><a href="UI.html#mainWrapper"><span class="hs-identifier hs-var">mainWrapper</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span class="annot"><span class="annottext">(Widget Event -&gt; AppView Window Event)
-&gt; Widget Event -&gt; AppView Window Event
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ManagedPtr Box -&gt; Box)
-&gt; Vector (Attribute Box Event)
-&gt; Vector (BoxChild Event)
-&gt; Widget Event
forall widget (child :: * -&gt; *) (target :: * -&gt; *)
       (parent :: * -&gt; *) event.
(Typeable widget, Functor child, IsWidget widget,
 IsContainer widget,
 FromWidget (Container widget (Children child)) target,
 ToChildren widget parent child) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event)
-&gt; parent (child event)
-&gt; target event
</span><span class="hs-identifier hs-var">container</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Box -&gt; Box
</span><span class="hs-identifier hs-var">Gtk.Box</span></span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
        #orientation := Gtk.OrientationVertical, 
</span><span class="hs-cpp">        #halign := Gtk.AlignCenter] [
</span><span>        </span><span class="hs-identifier">container</span><span> </span><span class="hs-identifier">Gtk.Box</span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
            #orientation := Gtk.OrientationVertical, 
</span><span class="hs-cpp">            #halign := Gtk.AlignCenter
</span><span>            </span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">winInformation</span><span> </span><span class="hs-identifier">winningPlayer</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-274"></span><span>        </span><span class="hs-identifier">container</span><span> </span><span class="hs-identifier">Gtk.Box</span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
            #orientation := Gtk.OrientationVertical, 
</span><span class="hs-cpp">            #halign := Gtk.AlignCenter
</span><span>            </span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pauseButton</span><span> </span><span class="hs-identifier">maybePaused</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-278"></span><span>        </span><span class="hs-identifier">container</span><span> </span><span class="hs-identifier">Gtk.Box</span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
            #orientation := Gtk.OrientationHorizontal
</span><span>            </span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-281"></span><span>            </span><span class="hs-identifier">container</span><span> </span><span class="hs-identifier">Gtk.Box</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- board container</span><span class="hs-cpp">
                #orientation := Gtk.OrientationVertical,
</span><span class="hs-cpp">                #margin := 12
</span><span>                </span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-285"></span><span>                </span><span class="hs-special">(</span><span class="hs-identifier">gameGrid</span><span> </span><span class="hs-identifier">gameState</span><span> </span><span class="hs-identifier">showMoves</span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-287"></span><span>        </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-288"></span><span>        </span><span class="hs-identifier">container</span><span> </span><span class="hs-identifier">Gtk.Box</span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
            #orientation := Gtk.OrientationVertical,
</span><span class="hs-cpp">            #margin := 10] [
</span><span>            </span><span class="hs-identifier">widget</span><span> </span><span class="hs-identifier">Gtk.Button</span><span> </span><span class="hs-special">[</span><span class="">#label</span><span> </span><span class="hs-operator">:=</span><span> </span><span class="hs-string">&quot;Back to Main Menu&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">on</span><span> </span><span class="">#clicked</span><span> </span><span class="hs-identifier">EndGame</span><span class="hs-special">,</span><span> </span><span class="">#halign</span><span> </span><span class="hs-operator">:=</span><span> </span><span class="hs-identifier">Gtk.AlignCenter</span><span class="hs-special">]</span><span>
</span><span id="line-292"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">-- | Returns a render of a given state</span><span>
</span><span id="line-296"></span><span class="annot"><a href="UI.html#view%27"><span class="hs-identifier hs-type">view'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UI.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AppView</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gtk.Window</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span>
</span><span id="line-297"></span><span class="hs-comment">-- Error window</span><span>
</span><span id="line-298"></span><span id="view%27"><span class="annot"><span class="annottext">view' :: State -&gt; AppView Window Event
</span><a href="UI.html#view%27"><span class="hs-identifier hs-var hs-var">view'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#ErrorWindow"><span class="hs-identifier hs-type">ErrorWindow</span></a></span><span> </span><span id="local-6989586621679211725"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679211725"><span class="hs-identifier hs-var">message</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><span class="annottext">Widget Event -&gt; AppView Window Event
</span><a href="UI.html#mainWrapper"><span class="hs-identifier hs-var">mainWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget Event -&gt; AppView Window Event)
-&gt; Widget Event -&gt; AppView Window Event
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; Widget Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213941"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679211725"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- Settings window</span><span>
</span><span id="line-301"></span><span class="annot"><a href="UI.html#view%27"><span class="hs-identifier hs-var">view'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span id="local-6989586621679211724"><span class="annot"><span class="annottext">boardSetting :: BoardSetting
</span><a href="#local-6989586621679211724"><span class="hs-identifier hs-var">boardSetting</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Game.html#BoardSetting"><span class="hs-identifier hs-type">BoardSetting</span></a></span><span> </span><span id="local-6989586621679211723"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211723"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679211722"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211722"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679211721"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211721"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679211720"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211720"><span class="hs-identifier hs-var">isRedComputer</span></a></span></span><span> </span><span id="local-6989586621679211719"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211719"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211718"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211718"><span class="hs-identifier hs-var">redSeed</span></a></span></span><span> </span><span id="local-6989586621679211717"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211717"><span class="hs-identifier hs-var">isBlueComputer</span></a></span></span><span> </span><span id="local-6989586621679211716"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211716"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211715"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211715"><span class="hs-identifier hs-var">blueSeed</span></a></span></span><span> </span><span id="local-6989586621679211714"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211714"><span class="hs-identifier hs-var">speed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><span class="annottext">Widget Event -&gt; AppView Window Event
</span><a href="UI.html#mainWrapper"><span class="hs-identifier hs-var">mainWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget Event -&gt; AppView Window Event)
-&gt; Widget Event -&gt; AppView Window Event
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ManagedPtr Box -&gt; Box)
-&gt; Vector (Attribute Box Event)
-&gt; Vector (BoxChild Event)
-&gt; Widget Event
forall widget (child :: * -&gt; *) (target :: * -&gt; *)
       (parent :: * -&gt; *) event.
(Typeable widget, Functor child, IsWidget widget,
 IsContainer widget,
 FromWidget (Container widget (Children child)) target,
 ToChildren widget parent child) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event)
-&gt; parent (child event)
-&gt; target event
</span><span class="hs-identifier hs-var">container</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Box -&gt; Box
</span><span class="hs-identifier hs-var">Gtk.Box</span></span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
        #orientation := Gtk.OrientationVertical,
</span><span class="hs-cpp">        #margin := 10
</span><span>        </span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-306"></span><span>        </span><span class="hs-comment">-- banner</span><span>
</span><span id="line-307"></span><span>        </span><span class="annot"><span class="annottext">(ManagedPtr Image -&gt; Image)
-&gt; Vector (Attribute Image Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Image -&gt; Image
</span><span class="hs-identifier hs-var">Gtk.Image</span></span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
            #halign := Gtk.AlignCenter, 
</span><span class="hs-cpp">            #file := &quot;img/banner.png&quot;
</span><span>        </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-comment">-- first row (board settings)</span><span>
</span><span id="line-312"></span><span>        </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
            #label := &quot;Board settings: &quot;, 
</span><span class="hs-cpp">            #halign := Gtk.AlignCenter,
</span><span class="hs-cpp">            #marginBottom := 4, 
</span><span>            </span><span class="annot"><span class="annottext">[Text] -&gt; Attribute Label Event
forall widget event.
IsWidget widget =&gt;
[Text] -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">classes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item [Text]
</span><span class="hs-string">&quot;header&quot;</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-317"></span><span>        </span><span class="annot"><span class="annottext">(ManagedPtr Box -&gt; Box)
-&gt; Vector (Attribute Box Event)
-&gt; Vector (BoxChild Event)
-&gt; BoxChild Event
forall widget (child :: * -&gt; *) (target :: * -&gt; *)
       (parent :: * -&gt; *) event.
(Typeable widget, Functor child, IsWidget widget,
 IsContainer widget,
 FromWidget (Container widget (Children child)) target,
 ToChildren widget parent child) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event)
-&gt; parent (child event)
-&gt; target event
</span><span class="hs-identifier hs-var">container</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Box -&gt; Box
</span><span class="hs-identifier hs-var">Gtk.Box</span></span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
            #orientation := Gtk.OrientationVertical
</span><span>            </span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-320"></span><span>            </span><span class="annot"><span class="annottext">(ManagedPtr Box -&gt; Box)
-&gt; Vector (Attribute Box Event)
-&gt; Vector (BoxChild Event)
-&gt; BoxChild Event
forall widget (child :: * -&gt; *) (target :: * -&gt; *)
       (parent :: * -&gt; *) event.
(Typeable widget, Functor child, IsWidget widget,
 IsContainer widget,
 FromWidget (Container widget (Children child)) target,
 ToChildren widget parent child) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event)
-&gt; parent (child event)
-&gt; target event
</span><span class="hs-identifier hs-var">container</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Box -&gt; Box
</span><span class="hs-identifier hs-var">Gtk.Box</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- rows settings</span><span class="hs-cpp">
                #marginTop := 8,
</span><span class="hs-cpp">                #spacing := 8
</span><span>            </span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-324"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213737"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Number of rows: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Attribute Label Event
forall widget event.
IsWidget widget =&gt;
[Text] -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">classes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item [Text]
</span><span class="hs-string">&quot;settingsLabel&quot;</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-325"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; Event) -&gt; BoxChild Event
</span><a href="UI.html#minusButton"><span class="hs-identifier hs-var">minusButton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211723"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211721"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679211713"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211713"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#MChanged"><span class="hs-identifier hs-var">MChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211713"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-326"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213715"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Data.Text.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211723"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;widthChars&quot; (AttrLabelProxy &quot;widthChars&quot;)
AttrLabelProxy &quot;widthChars&quot;
</span><a href="#local-6989586621679213699"><span class="hs-var">#widthChars</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;widthChars&quot; -&gt; Int32 -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;xalign&quot; (AttrLabelProxy &quot;xalign&quot;)
AttrLabelProxy &quot;xalign&quot;
</span><a href="#local-6989586621679213683"><span class="hs-var">#xalign</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;xalign&quot; -&gt; Float -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.5</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-327"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; Event) -&gt; BoxChild Event
</span><a href="UI.html#plusButton"><span class="hs-identifier hs-var">plusButton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211723"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GameConstants.html#maxRows"><span class="hs-identifier hs-var">GameConstants.maxRows</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679211710"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211710"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#MChanged"><span class="hs-identifier hs-var">MChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211710"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>            </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-329"></span><span>            </span><span class="annot"><span class="annottext">(ManagedPtr Box -&gt; Box)
-&gt; Vector (Attribute Box Event)
-&gt; Vector (BoxChild Event)
-&gt; BoxChild Event
forall widget (child :: * -&gt; *) (target :: * -&gt; *)
       (parent :: * -&gt; *) event.
(Typeable widget, Functor child, IsWidget widget,
 IsContainer widget,
 FromWidget (Container widget (Children child)) target,
 ToChildren widget parent child) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event)
-&gt; parent (child event)
-&gt; target event
</span><span class="hs-identifier hs-var">container</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Box -&gt; Box
</span><span class="hs-identifier hs-var">Gtk.Box</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- columns settings</span><span class="hs-cpp">
                #marginTop := 8,
</span><span class="hs-cpp">                #spacing := 8
</span><span>            </span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-333"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213624"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Number of columns: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Attribute Label Event
forall widget event.
IsWidget widget =&gt;
[Text] -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">classes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item [Text]
</span><span class="hs-string">&quot;settingsLabel&quot;</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-334"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; Event) -&gt; BoxChild Event
</span><a href="UI.html#minusButton"><span class="hs-identifier hs-var">minusButton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211722"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211721"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679211709"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211709"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#NChanged"><span class="hs-identifier hs-var">NChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211709"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-335"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213602"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Data.Text.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211722"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;widthChars&quot; (AttrLabelProxy &quot;widthChars&quot;)
AttrLabelProxy &quot;widthChars&quot;
</span><a href="#local-6989586621679213587"><span class="hs-var">#widthChars</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;widthChars&quot; -&gt; Int32 -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;xalign&quot; (AttrLabelProxy &quot;xalign&quot;)
AttrLabelProxy &quot;xalign&quot;
</span><a href="#local-6989586621679213572"><span class="hs-var">#xalign</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;xalign&quot; -&gt; Float -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.5</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-336"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; Event) -&gt; BoxChild Event
</span><a href="UI.html#plusButton"><span class="hs-identifier hs-var">plusButton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211722"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GameConstants.html#maxColumns"><span class="hs-identifier hs-var">GameConstants.maxColumns</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679211707"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211707"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#NChanged"><span class="hs-identifier hs-var">NChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211707"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>            </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-338"></span><span>            </span><span class="annot"><span class="annottext">(ManagedPtr Box -&gt; Box)
-&gt; Vector (Attribute Box Event)
-&gt; Vector (BoxChild Event)
-&gt; BoxChild Event
forall widget (child :: * -&gt; *) (target :: * -&gt; *)
       (parent :: * -&gt; *) event.
(Typeable widget, Functor child, IsWidget widget,
 IsContainer widget,
 FromWidget (Container widget (Children child)) target,
 ToChildren widget parent child) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event)
-&gt; parent (child event)
-&gt; target event
</span><span class="hs-identifier hs-var">container</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Box -&gt; Box
</span><span class="hs-identifier hs-var">Gtk.Box</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- winning line settings</span><span class="hs-cpp">
                #marginTop := 8,
</span><span class="hs-cpp">                #spacing := 8
</span><span>            </span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-342"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213514"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Length of line to win: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Attribute Label Event
forall widget event.
IsWidget widget =&gt;
[Text] -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">classes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item [Text]
</span><span class="hs-string">&quot;settingsLabel&quot;</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-343"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; Event) -&gt; BoxChild Event
</span><a href="UI.html#minusButton"><span class="hs-identifier hs-var">minusButton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211721"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GameConstants.html#minLine"><span class="hs-identifier hs-var">GameConstants.minLine</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679211705"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211705"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#KChanged"><span class="hs-identifier hs-var">KChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211705"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-344"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213492"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Data.Text.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211721"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;widthChars&quot; (AttrLabelProxy &quot;widthChars&quot;)
AttrLabelProxy &quot;widthChars&quot;
</span><a href="#local-6989586621679213477"><span class="hs-var">#widthChars</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;widthChars&quot; -&gt; Int32 -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;xalign&quot; (AttrLabelProxy &quot;xalign&quot;)
AttrLabelProxy &quot;xalign&quot;
</span><a href="#local-6989586621679213462"><span class="hs-var">#xalign</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;xalign&quot; -&gt; Float -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.5</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-345"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; Event) -&gt; BoxChild Event
</span><a href="UI.html#plusButton"><span class="hs-identifier hs-var">plusButton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211721"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211723"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211722"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679211703"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211703"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#KChanged"><span class="hs-identifier hs-var">KChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211703"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-347"></span><span>        </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-348"></span><span>        </span><span class="annot"><span class="annottext">(ManagedPtr Separator -&gt; Separator)
-&gt; Vector (Attribute Separator Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Separator -&gt; Separator
</span><span class="hs-identifier hs-var">Gtk.Separator</span></span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
            #margin := 16],
</span><span>        </span><span class="hs-comment">-- second row (player settings)</span><span>
</span><span id="line-351"></span><span>        </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
            #label := &quot;Players settings: &quot;, 
</span><span class="hs-cpp">            #halign := Gtk.AlignCenter,
</span><span class="hs-cpp">            #marginBottom := 4, 
</span><span>            </span><span class="annot"><span class="annottext">[Text] -&gt; Attribute Label Event
forall widget event.
IsWidget widget =&gt;
[Text] -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">classes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item [Text]
</span><span class="hs-string">&quot;header&quot;</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><span class="annottext">(ManagedPtr Box -&gt; Box)
-&gt; Vector (Attribute Box Event)
-&gt; Vector (BoxChild Event)
-&gt; BoxChild Event
forall widget (child :: * -&gt; *) (target :: * -&gt; *)
       (parent :: * -&gt; *) event.
(Typeable widget, Functor child, IsWidget widget,
 IsContainer widget,
 FromWidget (Container widget (Children child)) target,
 ToChildren widget parent child) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event)
-&gt; parent (child event)
-&gt; target event
</span><span class="hs-identifier hs-var">container</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Box -&gt; Box
</span><span class="hs-identifier hs-var">Gtk.Box</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- red player settings</span><span class="hs-cpp">
            #orientation := Gtk.OrientationHorizontal,
</span><span class="hs-cpp">            #marginTop := 8,
</span><span class="hs-cpp">            #spacing := 8
</span><span>            </span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-361"></span><span>            </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213316"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Red: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Attribute Label Event
forall widget event.
IsWidget widget =&gt;
[Text] -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">classes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item [Text]
</span><span class="hs-string">&quot;settingsLabel&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Item [Text]
</span><span class="hs-string">&quot;red&quot;</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-362"></span><span>            </span><span class="annot"><span class="annottext">(ManagedPtr Box -&gt; Box)
-&gt; Vector (Attribute Box Event)
-&gt; Vector (BoxChild Event)
-&gt; BoxChild Event
forall widget (child :: * -&gt; *) (target :: * -&gt; *)
       (parent :: * -&gt; *) event.
(Typeable widget, Functor child, IsWidget widget,
 IsContainer widget,
 FromWidget (Container widget (Children child)) target,
 ToChildren widget parent child) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event)
-&gt; parent (child event)
-&gt; target event
</span><span class="hs-identifier hs-var">container</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Box -&gt; Box
</span><span class="hs-identifier hs-var">Gtk.Box</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;spacing&quot; (AttrLabelProxy &quot;spacing&quot;)
AttrLabelProxy &quot;spacing&quot;
</span><a href="#local-6989586621679213289"><span class="hs-var">#spacing</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;spacing&quot; -&gt; Int32 -&gt; Attribute Box Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">8</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211720"><span class="hs-identifier hs-var">isRedComputer</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-363"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Button -&gt; Button)
-&gt; Vector (Attribute Button Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Button -&gt; Button
</span><span class="hs-identifier hs-var">Gtk.Button</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213269"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Button Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Computer&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SignalProxy Button ButtonClickedSignalInfo
-&gt; Event -&gt; Attribute Button Event
forall widget info gtkCallback userEventHandler event.
(GObject widget, SignalInfo info,
 gtkCallback ~ HaskellCallbackType info,
 ToGtkCallback gtkCallback 'Pure,
 ToEventHandler gtkCallback widget 'Pure,
 userEventHandler
 ~ UserEventHandler gtkCallback widget 'Pure event) =&gt;
SignalProxy widget info
-&gt; userEventHandler -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;clicked&quot; (SignalProxy Button ButtonClickedSignalInfo)
SignalProxy Button ButtonClickedSignalInfo
</span><a href="#local-6989586621679213258"><span class="hs-var">#clicked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Event
</span><a href="UI.html#RedTypeChanged"><span class="hs-identifier hs-var">RedTypeChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-364"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Separator -&gt; Separator)
-&gt; Vector (Attribute Separator Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Separator -&gt; Separator
</span><span class="hs-identifier hs-var">Gtk.Separator</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-365"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213236"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Difficulty:&quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-366"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; Event) -&gt; BoxChild Event
</span><a href="UI.html#minusButton"><span class="hs-identifier hs-var">minusButton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211719"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GameConstants.html#minDifficulty"><span class="hs-identifier hs-var">GameConstants.minDifficulty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679211700"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211700"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#RedDifficultyChanged"><span class="hs-identifier hs-var">RedDifficultyChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211700"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-367"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213217"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text
</span><a href="GameConstants.html#difficultyName"><span class="hs-identifier hs-var">GameConstants.difficultyName</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211719"><span class="hs-identifier hs-var">redD</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;widthChars&quot; (AttrLabelProxy &quot;widthChars&quot;)
AttrLabelProxy &quot;widthChars&quot;
</span><a href="#local-6989586621679213203"><span class="hs-var">#widthChars</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;widthChars&quot; -&gt; Int32 -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="GameConstants.html#maxDifficultyNameLength"><span class="hs-identifier hs-var">GameConstants.maxDifficultyNameLength</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;xalign&quot; (AttrLabelProxy &quot;xalign&quot;)
AttrLabelProxy &quot;xalign&quot;
</span><a href="#local-6989586621679213189"><span class="hs-var">#xalign</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;xalign&quot; -&gt; Float -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.5</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-368"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; Event) -&gt; BoxChild Event
</span><a href="UI.html#plusButton"><span class="hs-identifier hs-var">plusButton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211719"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GameConstants.html#maxDifficulty"><span class="hs-identifier hs-var">GameConstants.maxDifficulty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679211696"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211696"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#RedDifficultyChanged"><span class="hs-identifier hs-var">RedDifficultyChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211696"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-369"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Separator -&gt; Separator)
-&gt; Vector (Attribute Separator Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Separator -&gt; Separator
</span><span class="hs-identifier hs-var">Gtk.Separator</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-370"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213166"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Seed:&quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-371"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213147"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Data.Text.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211718"><span class="hs-identifier hs-var">redSeed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-372"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Button -&gt; Button)
-&gt; Vector (Attribute Button Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Button -&gt; Button
</span><span class="hs-identifier hs-var">Gtk.Button</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213128"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Button Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&#127922;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SignalProxy Button ButtonClickedSignalInfo
-&gt; Event -&gt; Attribute Button Event
forall widget info gtkCallback userEventHandler event.
(GObject widget, SignalInfo info,
 gtkCallback ~ HaskellCallbackType info,
 ToGtkCallback gtkCallback 'Pure,
 ToEventHandler gtkCallback widget 'Pure,
 userEventHandler
 ~ UserEventHandler gtkCallback widget 'Pure event) =&gt;
SignalProxy widget info
-&gt; userEventHandler -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;clicked&quot; (SignalProxy Button ButtonClickedSignalInfo)
SignalProxy Button ButtonClickedSignalInfo
</span><a href="#local-6989586621679213117"><span class="hs-var">#clicked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#RedSeedChanged"><span class="hs-identifier hs-var">RedSeedChanged</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, StdGen) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; StdGen -&gt; (Int, StdGen)
forall g a. (RandomGen g, UniformRange a) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><span class="hs-identifier hs-var">System.Random.uniformR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9999</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; StdGen
</span><span class="hs-identifier hs-var">System.Random.mkStdGen</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211718"><span class="hs-identifier hs-var">redSeed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-373"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-374"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-375"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Button -&gt; Button)
-&gt; Vector (Attribute Button Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Button -&gt; Button
</span><span class="hs-identifier hs-var">Gtk.Button</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213092"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Button Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Player&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SignalProxy Button ButtonClickedSignalInfo
-&gt; Event -&gt; Attribute Button Event
forall widget info gtkCallback userEventHandler event.
(GObject widget, SignalInfo info,
 gtkCallback ~ HaskellCallbackType info,
 ToGtkCallback gtkCallback 'Pure,
 ToEventHandler gtkCallback widget 'Pure,
 userEventHandler
 ~ UserEventHandler gtkCallback widget 'Pure event) =&gt;
SignalProxy widget info
-&gt; userEventHandler -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;clicked&quot; (SignalProxy Button ButtonClickedSignalInfo)
SignalProxy Button ButtonClickedSignalInfo
</span><a href="#local-6989586621679213081"><span class="hs-var">#clicked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Event
</span><a href="UI.html#RedTypeChanged"><span class="hs-identifier hs-var">RedTypeChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-376"></span><span>            </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>        </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-378"></span><span>        </span><span class="annot"><span class="annottext">(ManagedPtr Box -&gt; Box)
-&gt; Vector (Attribute Box Event)
-&gt; Vector (BoxChild Event)
-&gt; BoxChild Event
forall widget (child :: * -&gt; *) (target :: * -&gt; *)
       (parent :: * -&gt; *) event.
(Typeable widget, Functor child, IsWidget widget,
 IsContainer widget,
 FromWidget (Container widget (Children child)) target,
 ToChildren widget parent child) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event)
-&gt; parent (child event)
-&gt; target event
</span><span class="hs-identifier hs-var">container</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Box -&gt; Box
</span><span class="hs-identifier hs-var">Gtk.Box</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- blue player settings</span><span class="hs-cpp">
            #orientation := Gtk.OrientationHorizontal,
</span><span class="hs-cpp">            #marginTop := 8,
</span><span class="hs-cpp">            #spacing := 8
</span><span>            </span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-383"></span><span>            </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679213010"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Blue: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Attribute Label Event
forall widget event.
IsWidget widget =&gt;
[Text] -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">classes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item [Text]
</span><span class="hs-string">&quot;settingsLabel&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Item [Text]
</span><span class="hs-string">&quot;blue&quot;</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-384"></span><span>            </span><span class="annot"><span class="annottext">(ManagedPtr Box -&gt; Box)
-&gt; Vector (Attribute Box Event)
-&gt; Vector (BoxChild Event)
-&gt; BoxChild Event
forall widget (child :: * -&gt; *) (target :: * -&gt; *)
       (parent :: * -&gt; *) event.
(Typeable widget, Functor child, IsWidget widget,
 IsContainer widget,
 FromWidget (Container widget (Children child)) target,
 ToChildren widget parent child) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event)
-&gt; parent (child event)
-&gt; target event
</span><span class="hs-identifier hs-var">container</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Box -&gt; Box
</span><span class="hs-identifier hs-var">Gtk.Box</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;spacing&quot; (AttrLabelProxy &quot;spacing&quot;)
AttrLabelProxy &quot;spacing&quot;
</span><a href="#local-6989586621679212983"><span class="hs-var">#spacing</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;spacing&quot; -&gt; Int32 -&gt; Attribute Box Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">8</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211717"><span class="hs-identifier hs-var">isBlueComputer</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-385"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Button -&gt; Button)
-&gt; Vector (Attribute Button Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Button -&gt; Button
</span><span class="hs-identifier hs-var">Gtk.Button</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679212963"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Button Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Computer&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SignalProxy Button ButtonClickedSignalInfo
-&gt; Event -&gt; Attribute Button Event
forall widget info gtkCallback userEventHandler event.
(GObject widget, SignalInfo info,
 gtkCallback ~ HaskellCallbackType info,
 ToGtkCallback gtkCallback 'Pure,
 ToEventHandler gtkCallback widget 'Pure,
 userEventHandler
 ~ UserEventHandler gtkCallback widget 'Pure event) =&gt;
SignalProxy widget info
-&gt; userEventHandler -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;clicked&quot; (SignalProxy Button ButtonClickedSignalInfo)
SignalProxy Button ButtonClickedSignalInfo
</span><a href="#local-6989586621679212952"><span class="hs-var">#clicked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Event
</span><a href="UI.html#BlueTypeChanged"><span class="hs-identifier hs-var">BlueTypeChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-386"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Separator -&gt; Separator)
-&gt; Vector (Attribute Separator Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Separator -&gt; Separator
</span><span class="hs-identifier hs-var">Gtk.Separator</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-387"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679212930"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Difficulty:&quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-388"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; Event) -&gt; BoxChild Event
</span><a href="UI.html#minusButton"><span class="hs-identifier hs-var">minusButton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211716"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GameConstants.html#minDifficulty"><span class="hs-identifier hs-var">GameConstants.minDifficulty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679211693"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211693"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#BlueDifficultyChanged"><span class="hs-identifier hs-var">BlueDifficultyChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211693"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-389"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679212911"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text
</span><a href="GameConstants.html#difficultyName"><span class="hs-identifier hs-var">GameConstants.difficultyName</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211716"><span class="hs-identifier hs-var">blueD</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;widthChars&quot; (AttrLabelProxy &quot;widthChars&quot;)
AttrLabelProxy &quot;widthChars&quot;
</span><a href="#local-6989586621679212897"><span class="hs-var">#widthChars</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;widthChars&quot; -&gt; Int32 -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="GameConstants.html#maxDifficultyNameLength"><span class="hs-identifier hs-var">GameConstants.maxDifficultyNameLength</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;xalign&quot; (AttrLabelProxy &quot;xalign&quot;)
AttrLabelProxy &quot;xalign&quot;
</span><a href="#local-6989586621679212883"><span class="hs-var">#xalign</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;xalign&quot; -&gt; Float -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.5</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-390"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; Event) -&gt; BoxChild Event
</span><a href="UI.html#plusButton"><span class="hs-identifier hs-var">plusButton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211716"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GameConstants.html#maxDifficulty"><span class="hs-identifier hs-var">GameConstants.maxDifficulty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679211692"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211692"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#BlueDifficultyChanged"><span class="hs-identifier hs-var">BlueDifficultyChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211692"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-391"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Separator -&gt; Separator)
-&gt; Vector (Attribute Separator Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Separator -&gt; Separator
</span><span class="hs-identifier hs-var">Gtk.Separator</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-392"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679212860"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Seed:&quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-393"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679212841"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Data.Text.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211715"><span class="hs-identifier hs-var">blueSeed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;widthChars&quot; (AttrLabelProxy &quot;widthChars&quot;)
AttrLabelProxy &quot;widthChars&quot;
</span><a href="#local-6989586621679212826"><span class="hs-var">#widthChars</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;widthChars&quot; -&gt; Int32 -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-394"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Button -&gt; Button)
-&gt; Vector (Attribute Button Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Button -&gt; Button
</span><span class="hs-identifier hs-var">Gtk.Button</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679212807"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Button Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&#127922;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SignalProxy Button ButtonClickedSignalInfo
-&gt; Event -&gt; Attribute Button Event
forall widget info gtkCallback userEventHandler event.
(GObject widget, SignalInfo info,
 gtkCallback ~ HaskellCallbackType info,
 ToGtkCallback gtkCallback 'Pure,
 ToEventHandler gtkCallback widget 'Pure,
 userEventHandler
 ~ UserEventHandler gtkCallback widget 'Pure event) =&gt;
SignalProxy widget info
-&gt; userEventHandler -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;clicked&quot; (SignalProxy Button ButtonClickedSignalInfo)
SignalProxy Button ButtonClickedSignalInfo
</span><a href="#local-6989586621679212796"><span class="hs-var">#clicked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#BlueSeedChanged"><span class="hs-identifier hs-var">BlueSeedChanged</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, StdGen) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; StdGen -&gt; (Int, StdGen)
forall g a. (RandomGen g, UniformRange a) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><span class="hs-identifier hs-var">System.Random.uniformR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9999</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; StdGen
</span><span class="hs-identifier hs-var">System.Random.mkStdGen</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211715"><span class="hs-identifier hs-var">blueSeed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-395"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-396"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-397"></span><span>                </span><span class="annot"><span class="annottext">(ManagedPtr Button -&gt; Button)
-&gt; Vector (Attribute Button Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Button -&gt; Button
</span><span class="hs-identifier hs-var">Gtk.Button</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679212773"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Button Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Player&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SignalProxy Button ButtonClickedSignalInfo
-&gt; Event -&gt; Attribute Button Event
forall widget info gtkCallback userEventHandler event.
(GObject widget, SignalInfo info,
 gtkCallback ~ HaskellCallbackType info,
 ToGtkCallback gtkCallback 'Pure,
 ToEventHandler gtkCallback widget 'Pure,
 userEventHandler
 ~ UserEventHandler gtkCallback widget 'Pure event) =&gt;
SignalProxy widget info
-&gt; userEventHandler -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;clicked&quot; (SignalProxy Button ButtonClickedSignalInfo)
SignalProxy Button ButtonClickedSignalInfo
</span><a href="#local-6989586621679212762"><span class="hs-var">#clicked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Event
</span><a href="UI.html#BlueTypeChanged"><span class="hs-identifier hs-var">BlueTypeChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-398"></span><span>            </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>        </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-400"></span><span>        </span><span class="annot"><span class="annottext">(ManagedPtr Box -&gt; Box)
-&gt; Vector (Attribute Box Event)
-&gt; Vector (BoxChild Event)
-&gt; BoxChild Event
forall widget (child :: * -&gt; *) (target :: * -&gt; *)
       (parent :: * -&gt; *) event.
(Typeable widget, Functor child, IsWidget widget,
 IsContainer widget,
 FromWidget (Container widget (Children child)) target,
 ToChildren widget parent child) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event)
-&gt; parent (child event)
-&gt; target event
</span><span class="hs-identifier hs-var">container</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Box -&gt; Box
</span><span class="hs-identifier hs-var">Gtk.Box</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- speed settings</span><span class="hs-cpp">
            #orientation := Gtk.OrientationHorizontal,
</span><span class="hs-cpp">            #marginTop := 8,
</span><span class="hs-cpp">            #spacing := 8
</span><span>        </span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211717"><span class="hs-identifier hs-var">isBlueComputer</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211720"><span class="hs-identifier hs-var">isRedComputer</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-405"></span><span>            </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679212691"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Additional delay between moves (not from computing AI's move): &quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-406"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; Event) -&gt; BoxChild Event
</span><a href="UI.html#minusButton"><span class="hs-identifier hs-var">minusButton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211714"><span class="hs-identifier hs-var">speed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="UI.html#minSpeed"><span class="hs-identifier hs-var">minSpeed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679211690"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211690"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#SpeedChanged"><span class="hs-identifier hs-var">SpeedChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211690"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-407"></span><span>            </span><span class="annot"><span class="annottext">(ManagedPtr Label -&gt; Label)
-&gt; Vector (Attribute Label Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Label -&gt; Label
</span><span class="hs-identifier hs-var">Gtk.Label</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679212672"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Label Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Data.Text.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211714"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-operator hs-var">`Data.Text.append`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;s&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-408"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; Event) -&gt; BoxChild Event
</span><a href="UI.html#plusButton"><span class="hs-identifier hs-var">plusButton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211714"><span class="hs-identifier hs-var">speed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="UI.html#maxSpeed"><span class="hs-identifier hs-var">maxSpeed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679211688"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211688"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#SpeedChanged"><span class="hs-identifier hs-var">SpeedChanged</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211688"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>            </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-410"></span><span>        </span><span class="annot"><span class="annottext">(ManagedPtr Separator -&gt; Separator)
-&gt; Vector (Attribute Separator Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Separator -&gt; Separator
</span><span class="hs-identifier hs-var">Gtk.Separator</span></span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
            #margin := 16],
</span><span>        </span><span class="hs-comment">-- third row (containing start game button)</span><span>
</span><span id="line-413"></span><span>        </span><span class="annot"><span class="annottext">(ManagedPtr Box -&gt; Box)
-&gt; Vector (Attribute Box Event)
-&gt; Vector (BoxChild Event)
-&gt; BoxChild Event
forall widget (child :: * -&gt; *) (target :: * -&gt; *)
       (parent :: * -&gt; *) event.
(Typeable widget, Functor child, IsWidget widget,
 IsContainer widget,
 FromWidget (Container widget (Children child)) target,
 ToChildren widget parent child) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event)
-&gt; parent (child event)
-&gt; target event
</span><span class="hs-identifier hs-var">container</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Box -&gt; Box
</span><span class="hs-identifier hs-var">Gtk.Box</span></span><span> </span><span class="hs-special">[</span><span class="hs-cpp">
            #orientation := Gtk.OrientationVertical
</span><span>            </span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-416"></span><span>            </span><span class="annot"><span class="annottext">(ManagedPtr Button -&gt; Button)
-&gt; Vector (Attribute Button Event) -&gt; BoxChild Event
forall widget (target :: * -&gt; *) event.
(Typeable widget, IsWidget widget,
 FromWidget (SingleWidget widget) target) =&gt;
(ManagedPtr widget -&gt; widget)
-&gt; Vector (Attribute widget event) -&gt; target event
</span><span class="hs-identifier hs-var">widget</span></span><span> </span><span class="annot"><span class="annottext">ManagedPtr Button -&gt; Button
</span><span class="hs-identifier hs-var">Gtk.Button</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IsLabel &quot;label&quot; (AttrLabelProxy &quot;label&quot;)
AttrLabelProxy &quot;label&quot;
</span><a href="#local-6989586621679212602"><span class="hs-var">#label</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;label&quot; -&gt; Text -&gt; Attribute Button Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Start game&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SignalProxy Button ButtonClickedSignalInfo
-&gt; Event -&gt; Attribute Button Event
forall widget info gtkCallback userEventHandler event.
(GObject widget, SignalInfo info,
 gtkCallback ~ HaskellCallbackType info,
 ToGtkCallback gtkCallback 'Pure,
 ToEventHandler gtkCallback widget 'Pure,
 userEventHandler
 ~ UserEventHandler gtkCallback widget 'Pure event) =&gt;
SignalProxy widget info
-&gt; userEventHandler -&gt; Attribute widget event
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;clicked&quot; (SignalProxy Button ButtonClickedSignalInfo)
SignalProxy Button ButtonClickedSignalInfo
</span><a href="#local-6989586621679212591"><span class="hs-var">#clicked</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="UI.html#StartGame"><span class="hs-identifier hs-var">StartGame</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;halign&quot; (AttrLabelProxy &quot;halign&quot;)
AttrLabelProxy &quot;halign&quot;
</span><a href="#local-6989586621679212577"><span class="hs-var">#halign</span></a></span><span> </span><span class="annot"><span class="annottext">AttrLabelProxy &quot;halign&quot; -&gt; Align -&gt; Attribute Button Event
forall info widget (attr :: Symbol) getValue setValue event.
(AttrOpAllowed 'AttrConstruct info widget,
 AttrOpAllowed 'AttrSet info widget,
 AttrGetC info widget attr getValue,
 AttrSetTypeConstraint info setValue, KnownSymbol attr,
 Typeable attr, Eq setValue, Typeable setValue) =&gt;
AttrLabelProxy attr -&gt; setValue -&gt; Attribute widget event
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">Align
</span><span class="hs-identifier hs-var">Gtk.AlignCenter</span></span><span class="hs-special">]</span><span>
</span><span id="line-417"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-419"></span><span class="annot"><a href="UI.html#view%27"><span class="hs-identifier hs-var">view'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#UserVSUserWindow"><span class="hs-identifier hs-type">UserVSUserWindow</span></a></span><span> </span><span id="local-6989586621679211687"><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211687"><span class="hs-identifier hs-var">gameState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-420"></span><span>    </span><span class="annot"><span class="annottext">GameState
-&gt; Bool -&gt; Maybe Player -&gt; Maybe Bool -&gt; AppView Window Event
</span><a href="UI.html#gameWindow"><span class="hs-identifier hs-var">gameWindow</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211687"><span class="hs-identifier hs-var">gameState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Player -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Player
</span><a href="#local-6989586621679211685"><span class="hs-identifier hs-var">winningPlayer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Player
</span><a href="#local-6989586621679211685"><span class="hs-identifier hs-var">winningPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-421"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-422"></span><span>        </span><span id="local-6989586621679211685"><span class="annot"><span class="annottext">winningPlayer :: Maybe Player
</span><a href="#local-6989586621679211685"><span class="hs-identifier hs-var hs-var">winningPlayer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Maybe Player
</span><a href="Game.html#whoWins"><span class="hs-identifier hs-var">Game.whoWins</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211687"><span class="hs-identifier hs-var">gameState</span></a></span><span>
</span><span id="line-423"></span><span class="annot"><a href="UI.html#view%27"><span class="hs-identifier hs-var">view'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#UserVSComputerWindow"><span class="hs-identifier hs-type">UserVSComputerWindow</span></a></span><span> </span><span id="local-6989586621679211683"><span class="annot"><span class="annottext">gameState :: GameState
</span><a href="#local-6989586621679211683"><span class="hs-identifier hs-var">gameState</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Game.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BoardState
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679211682"><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211682"><span class="hs-identifier hs-var">currentPlayer</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679211681"><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211681"><span class="hs-identifier hs-var">computerColor</span></a></span></span><span> </span><span id="local-6989586621679211680"><span class="annot"><span class="annottext">AISetting
</span><a href="#local-6989586621679211680"><span class="hs-identifier hs-var">computerSetting</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><span class="annottext">GameState
-&gt; Bool -&gt; Maybe Player -&gt; Maybe Bool -&gt; AppView Window Event
</span><a href="UI.html#gameWindow"><span class="hs-identifier hs-var">gameWindow</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211683"><span class="hs-identifier hs-var">gameState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Player -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Player
</span><a href="#local-6989586621679211679"><span class="hs-identifier hs-var">winningPlayer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211681"><span class="hs-identifier hs-var">computerColor</span></a></span><span> </span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211682"><span class="hs-identifier hs-var">currentPlayer</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Player
</span><a href="#local-6989586621679211679"><span class="hs-identifier hs-var">winningPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-425"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-426"></span><span>        </span><span id="local-6989586621679211679"><span class="annot"><span class="annottext">winningPlayer :: Maybe Player
</span><a href="#local-6989586621679211679"><span class="hs-identifier hs-var hs-var">winningPlayer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Maybe Player
</span><a href="Game.html#whoWins"><span class="hs-identifier hs-var">Game.whoWins</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211683"><span class="hs-identifier hs-var">gameState</span></a></span><span>
</span><span id="line-427"></span><span class="annot"><a href="UI.html#view%27"><span class="hs-identifier hs-var">view'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#ComputerVSComputerWindow"><span class="hs-identifier hs-type">ComputerVSComputerWindow</span></a></span><span> </span><span id="local-6989586621679211677"><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211677"><span class="hs-identifier hs-var">gameState</span></a></span></span><span> </span><span id="local-6989586621679211676"><span class="annot"><span class="annottext">AISetting
</span><a href="#local-6989586621679211676"><span class="hs-identifier hs-var">redSetting</span></a></span></span><span> </span><span id="local-6989586621679211675"><span class="annot"><span class="annottext">AISetting
</span><a href="#local-6989586621679211675"><span class="hs-identifier hs-var">blueSetting</span></a></span></span><span> </span><span id="local-6989586621679211674"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211674"><span class="hs-identifier hs-var">speed</span></a></span></span><span> </span><span id="local-6989586621679211673"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211673"><span class="hs-identifier hs-var">paused</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><span class="annottext">GameState
-&gt; Bool -&gt; Maybe Player -&gt; Maybe Bool -&gt; AppView Window Event
</span><a href="UI.html#gameWindow"><span class="hs-identifier hs-var">gameWindow</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211677"><span class="hs-identifier hs-var">gameState</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Maybe Player
</span><a href="#local-6989586621679211672"><span class="hs-identifier hs-var">winningPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679211671"><span class="hs-identifier hs-var">pauseInformation</span></a></span><span> </span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-430"></span><span>        </span><span id="local-6989586621679211672"><span class="annot"><span class="annottext">winningPlayer :: Maybe Player
</span><a href="#local-6989586621679211672"><span class="hs-identifier hs-var hs-var">winningPlayer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Maybe Player
</span><a href="Game.html#whoWins"><span class="hs-identifier hs-var">Game.whoWins</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211677"><span class="hs-identifier hs-var">gameState</span></a></span><span>
</span><span id="line-431"></span><span>        </span><span id="local-6989586621679211671"><span class="annot"><span class="annottext">pauseInformation :: Maybe Bool
</span><a href="#local-6989586621679211671"><span class="hs-identifier hs-var hs-var">pauseInformation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Player
</span><a href="#local-6989586621679211672"><span class="hs-identifier hs-var">winningPlayer</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-432"></span><span>            </span><span class="annot"><span class="annottext">Maybe Player
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211673"><span class="hs-identifier hs-var">paused</span></a></span><span>
</span><span id="line-433"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="hs-comment">-- | Just transition to a given state not doing any IO action or producing any more events.</span><span>
</span><span id="line-437"></span><span class="annot"><a href="UI.html#simpleTrans"><span class="hs-identifier hs-type">simpleTrans</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UI.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Transition</span></span><span> </span><span class="annot"><a href="UI.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span>
</span><span id="line-438"></span><span id="simpleTrans"><span class="annot"><span class="annottext">simpleTrans :: State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var hs-var">simpleTrans</span></a></span></span><span> </span><span id="local-6989586621679211669"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679211669"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; IO (Maybe Event) -&gt; Transition State Event
forall state event.
state -&gt; IO (Maybe event) -&gt; Transition state event
</span><span class="hs-identifier hs-var">Transition</span></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679211669"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Event -&gt; IO (Maybe Event)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Event
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-comment">-- | Wait given time and return given MaybeEvent.</span><span>
</span><span id="line-442"></span><span class="annot"><a href="UI.html#waitAndEvoke"><span class="hs-identifier hs-type">waitAndEvoke</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span id="waitAndEvoke"><span class="annot"><span class="annottext">waitAndEvoke :: Maybe Event -&gt; Int -&gt; IO (Maybe Event)
</span><a href="UI.html#waitAndEvoke"><span class="hs-identifier hs-var hs-var">waitAndEvoke</span></a></span></span><span> </span><span id="local-6989586621679211666"><span class="annot"><span class="annottext">Maybe Event
</span><a href="#local-6989586621679211666"><span class="hs-identifier hs-var">maybeEvent</span></a></span></span><span> </span><span id="local-6989586621679211665"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211665"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ButtonClickedCallback
</span><span class="hs-identifier hs-var">threadDelay</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211665"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ButtonClickedCallback -&gt; IO (Maybe Event) -&gt; IO (Maybe Event)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Event -&gt; IO (Maybe Event)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Event
</span><a href="#local-6989586621679211666"><span class="hs-identifier hs-var">maybeEvent</span></a></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="hs-comment">-- | For a given state and an event returns Transition to a next state.</span><span>
</span><span id="line-447"></span><span class="hs-comment">--   Transition contains next state and does some IO action that may result in a next event that will be evoken.</span><span>
</span><span id="line-448"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-type">update'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UI.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Transition</span></span><span> </span><span class="annot"><a href="UI.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="UI.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span>
</span><span id="line-449"></span><span class="hs-comment">-- closing Window</span><span>
</span><span id="line-450"></span><span id="update%27"><span class="annot"><span class="annottext">update' :: State -&gt; Event -&gt; Transition State Event
</span><a href="UI.html#update%27"><span class="hs-identifier hs-var hs-var">update'</span></a></span></span><span> </span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="UI.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Transition State Event
forall state event. Transition state event
</span><span class="hs-identifier hs-var">Exit</span></span><span>
</span><span id="line-451"></span><span class="hs-comment">-- setting field values in Settings Window</span><span>
</span><span id="line-452"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Game.html#BoardSetting"><span class="hs-identifier hs-type">Game.BoardSetting</span></a></span><span> </span><span id="local-6989586621679211662"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211662"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679211661"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211661"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679211660"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211660"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679211659"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211659"><span class="hs-identifier hs-var">redC</span></a></span></span><span> </span><span id="local-6989586621679211658"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211658"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211657"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211657"><span class="hs-identifier hs-var">redSeed</span></a></span></span><span> </span><span id="local-6989586621679211656"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211656"><span class="hs-identifier hs-var">blueC</span></a></span></span><span> </span><span id="local-6989586621679211655"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211655"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211654"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211654"><span class="hs-identifier hs-var">blueSeed</span></a></span></span><span> </span><span id="local-6989586621679211653"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211653"><span class="hs-identifier hs-var">speed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#MChanged"><span class="hs-identifier hs-type">MChanged</span></a></span><span> </span><span id="local-6989586621679211652"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211652"><span class="hs-identifier hs-var">newM</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting
-&gt; Bool -&gt; Int -&gt; Int -&gt; Bool -&gt; Int -&gt; Int -&gt; Int -&gt; State
</span><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-var">SettingsWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; BoardSetting
</span><a href="Game.html#BoardSetting"><span class="hs-identifier hs-var">Game.BoardSetting</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211652"><span class="hs-identifier hs-var">newM</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211661"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211660"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211659"><span class="hs-identifier hs-var">redC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211658"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211657"><span class="hs-identifier hs-var">redSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211656"><span class="hs-identifier hs-var">blueC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211655"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211654"><span class="hs-identifier hs-var">blueSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211653"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Game.html#BoardSetting"><span class="hs-identifier hs-type">Game.BoardSetting</span></a></span><span> </span><span id="local-6989586621679211651"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211651"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679211650"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211650"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679211649"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211649"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679211648"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211648"><span class="hs-identifier hs-var">redC</span></a></span></span><span> </span><span id="local-6989586621679211647"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211647"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211646"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211646"><span class="hs-identifier hs-var">redSeed</span></a></span></span><span> </span><span id="local-6989586621679211645"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211645"><span class="hs-identifier hs-var">blueC</span></a></span></span><span> </span><span id="local-6989586621679211644"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211644"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211643"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211643"><span class="hs-identifier hs-var">blueSeed</span></a></span></span><span> </span><span id="local-6989586621679211642"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211642"><span class="hs-identifier hs-var">speed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#NChanged"><span class="hs-identifier hs-type">NChanged</span></a></span><span> </span><span id="local-6989586621679211641"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211641"><span class="hs-identifier hs-var">newN</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-455"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting
-&gt; Bool -&gt; Int -&gt; Int -&gt; Bool -&gt; Int -&gt; Int -&gt; Int -&gt; State
</span><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-var">SettingsWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; BoardSetting
</span><a href="Game.html#BoardSetting"><span class="hs-identifier hs-var">Game.BoardSetting</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211651"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211641"><span class="hs-identifier hs-var">newN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211649"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211648"><span class="hs-identifier hs-var">redC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211647"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211646"><span class="hs-identifier hs-var">redSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211645"><span class="hs-identifier hs-var">blueC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211644"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211643"><span class="hs-identifier hs-var">blueSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211642"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-456"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Game.html#BoardSetting"><span class="hs-identifier hs-type">Game.BoardSetting</span></a></span><span> </span><span id="local-6989586621679211640"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211640"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679211639"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211639"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679211638"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211638"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679211637"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211637"><span class="hs-identifier hs-var">redC</span></a></span></span><span> </span><span id="local-6989586621679211636"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211636"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211635"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211635"><span class="hs-identifier hs-var">redSeed</span></a></span></span><span> </span><span id="local-6989586621679211634"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211634"><span class="hs-identifier hs-var">blueC</span></a></span></span><span> </span><span id="local-6989586621679211633"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211633"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211632"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211632"><span class="hs-identifier hs-var">blueSeed</span></a></span></span><span> </span><span id="local-6989586621679211631"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211631"><span class="hs-identifier hs-var">speed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#KChanged"><span class="hs-identifier hs-type">KChanged</span></a></span><span> </span><span id="local-6989586621679211630"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211630"><span class="hs-identifier hs-var">newK</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting
-&gt; Bool -&gt; Int -&gt; Int -&gt; Bool -&gt; Int -&gt; Int -&gt; Int -&gt; State
</span><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-var">SettingsWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; BoardSetting
</span><a href="Game.html#BoardSetting"><span class="hs-identifier hs-var">Game.BoardSetting</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211640"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211639"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211630"><span class="hs-identifier hs-var">newK</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211637"><span class="hs-identifier hs-var">redC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211636"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211635"><span class="hs-identifier hs-var">redSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211634"><span class="hs-identifier hs-var">blueC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211633"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211632"><span class="hs-identifier hs-var">blueSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211631"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span id="local-6989586621679211629"><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211629"><span class="hs-identifier hs-var">board</span></a></span></span><span> </span><span id="local-6989586621679211628"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211628"><span class="hs-identifier hs-var">redC</span></a></span></span><span> </span><span id="local-6989586621679211627"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211627"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211626"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211626"><span class="hs-identifier hs-var">redSeed</span></a></span></span><span> </span><span id="local-6989586621679211625"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211625"><span class="hs-identifier hs-var">blueC</span></a></span></span><span> </span><span id="local-6989586621679211624"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211624"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211623"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211623"><span class="hs-identifier hs-var">blueSeed</span></a></span></span><span> </span><span id="local-6989586621679211622"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211622"><span class="hs-identifier hs-var">speed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#RedTypeChanged"><span class="hs-identifier hs-type">RedTypeChanged</span></a></span><span> </span><span id="local-6989586621679211621"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211621"><span class="hs-identifier hs-var">newRedC</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-459"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting
-&gt; Bool -&gt; Int -&gt; Int -&gt; Bool -&gt; Int -&gt; Int -&gt; Int -&gt; State
</span><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-var">SettingsWindow</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211629"><span class="hs-identifier hs-var">board</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211621"><span class="hs-identifier hs-var">newRedC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211627"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211626"><span class="hs-identifier hs-var">redSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211625"><span class="hs-identifier hs-var">blueC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211624"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211623"><span class="hs-identifier hs-var">blueSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211622"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span id="local-6989586621679211620"><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211620"><span class="hs-identifier hs-var">board</span></a></span></span><span> </span><span id="local-6989586621679211619"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211619"><span class="hs-identifier hs-var">redC</span></a></span></span><span> </span><span id="local-6989586621679211618"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211618"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211617"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211617"><span class="hs-identifier hs-var">redSeed</span></a></span></span><span> </span><span id="local-6989586621679211616"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211616"><span class="hs-identifier hs-var">blueC</span></a></span></span><span> </span><span id="local-6989586621679211615"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211615"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211614"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211614"><span class="hs-identifier hs-var">blueSeed</span></a></span></span><span> </span><span id="local-6989586621679211613"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211613"><span class="hs-identifier hs-var">speed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#BlueTypeChanged"><span class="hs-identifier hs-type">BlueTypeChanged</span></a></span><span> </span><span id="local-6989586621679211612"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211612"><span class="hs-identifier hs-var">newBlueC</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting
-&gt; Bool -&gt; Int -&gt; Int -&gt; Bool -&gt; Int -&gt; Int -&gt; Int -&gt; State
</span><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-var">SettingsWindow</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211620"><span class="hs-identifier hs-var">board</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211619"><span class="hs-identifier hs-var">redC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211618"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211617"><span class="hs-identifier hs-var">redSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211612"><span class="hs-identifier hs-var">newBlueC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211615"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211614"><span class="hs-identifier hs-var">blueSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211613"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span id="local-6989586621679211611"><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211611"><span class="hs-identifier hs-var">board</span></a></span></span><span> </span><span id="local-6989586621679211610"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211610"><span class="hs-identifier hs-var">redC</span></a></span></span><span> </span><span id="local-6989586621679211609"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211609"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211608"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211608"><span class="hs-identifier hs-var">redSeed</span></a></span></span><span> </span><span id="local-6989586621679211607"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211607"><span class="hs-identifier hs-var">blueC</span></a></span></span><span> </span><span id="local-6989586621679211606"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211606"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211605"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211605"><span class="hs-identifier hs-var">blueSeed</span></a></span></span><span> </span><span id="local-6989586621679211604"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211604"><span class="hs-identifier hs-var">speed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#RedDifficultyChanged"><span class="hs-identifier hs-type">RedDifficultyChanged</span></a></span><span> </span><span id="local-6989586621679211603"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211603"><span class="hs-identifier hs-var">newRedD</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-463"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting
-&gt; Bool -&gt; Int -&gt; Int -&gt; Bool -&gt; Int -&gt; Int -&gt; Int -&gt; State
</span><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-var">SettingsWindow</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211611"><span class="hs-identifier hs-var">board</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211610"><span class="hs-identifier hs-var">redC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211603"><span class="hs-identifier hs-var">newRedD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211608"><span class="hs-identifier hs-var">redSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211607"><span class="hs-identifier hs-var">blueC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211606"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211605"><span class="hs-identifier hs-var">blueSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211604"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span id="local-6989586621679211602"><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211602"><span class="hs-identifier hs-var">board</span></a></span></span><span> </span><span id="local-6989586621679211601"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211601"><span class="hs-identifier hs-var">redC</span></a></span></span><span> </span><span id="local-6989586621679211600"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211600"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211599"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211599"><span class="hs-identifier hs-var">redSeed</span></a></span></span><span> </span><span id="local-6989586621679211598"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211598"><span class="hs-identifier hs-var">blueC</span></a></span></span><span> </span><span id="local-6989586621679211597"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211597"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211596"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211596"><span class="hs-identifier hs-var">blueSeed</span></a></span></span><span> </span><span id="local-6989586621679211595"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211595"><span class="hs-identifier hs-var">speed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#BlueDifficultyChanged"><span class="hs-identifier hs-type">BlueDifficultyChanged</span></a></span><span> </span><span id="local-6989586621679211594"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211594"><span class="hs-identifier hs-var">newBlueD</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-465"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting
-&gt; Bool -&gt; Int -&gt; Int -&gt; Bool -&gt; Int -&gt; Int -&gt; Int -&gt; State
</span><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-var">SettingsWindow</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211602"><span class="hs-identifier hs-var">board</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211601"><span class="hs-identifier hs-var">redC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211600"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211599"><span class="hs-identifier hs-var">redSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211598"><span class="hs-identifier hs-var">blueC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211594"><span class="hs-identifier hs-var">newBlueD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211596"><span class="hs-identifier hs-var">blueSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211595"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span id="local-6989586621679211593"><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211593"><span class="hs-identifier hs-var">board</span></a></span></span><span> </span><span id="local-6989586621679211592"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211592"><span class="hs-identifier hs-var">redC</span></a></span></span><span> </span><span id="local-6989586621679211591"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211591"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211590"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211590"><span class="hs-identifier hs-var">redSeed</span></a></span></span><span> </span><span id="local-6989586621679211589"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211589"><span class="hs-identifier hs-var">blueC</span></a></span></span><span> </span><span id="local-6989586621679211588"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211588"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211587"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211587"><span class="hs-identifier hs-var">blueSeed</span></a></span></span><span> </span><span id="local-6989586621679211586"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211586"><span class="hs-identifier hs-var">speed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#RedSeedChanged"><span class="hs-identifier hs-type">RedSeedChanged</span></a></span><span> </span><span id="local-6989586621679211585"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211585"><span class="hs-identifier hs-var">newRedSeed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-467"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting
-&gt; Bool -&gt; Int -&gt; Int -&gt; Bool -&gt; Int -&gt; Int -&gt; Int -&gt; State
</span><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-var">SettingsWindow</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211593"><span class="hs-identifier hs-var">board</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211592"><span class="hs-identifier hs-var">redC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211591"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211585"><span class="hs-identifier hs-var">newRedSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211589"><span class="hs-identifier hs-var">blueC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211588"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211587"><span class="hs-identifier hs-var">blueSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211586"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span id="local-6989586621679211584"><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211584"><span class="hs-identifier hs-var">board</span></a></span></span><span> </span><span id="local-6989586621679211583"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211583"><span class="hs-identifier hs-var">redC</span></a></span></span><span> </span><span id="local-6989586621679211582"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211582"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211581"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211581"><span class="hs-identifier hs-var">redSeed</span></a></span></span><span> </span><span id="local-6989586621679211580"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211580"><span class="hs-identifier hs-var">blueC</span></a></span></span><span> </span><span id="local-6989586621679211579"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211579"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211578"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211578"><span class="hs-identifier hs-var">blueSeed</span></a></span></span><span> </span><span id="local-6989586621679211577"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211577"><span class="hs-identifier hs-var">speed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#BlueSeedChanged"><span class="hs-identifier hs-type">BlueSeedChanged</span></a></span><span> </span><span id="local-6989586621679211576"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211576"><span class="hs-identifier hs-var">newBlueSeed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-469"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting
-&gt; Bool -&gt; Int -&gt; Int -&gt; Bool -&gt; Int -&gt; Int -&gt; Int -&gt; State
</span><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-var">SettingsWindow</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211584"><span class="hs-identifier hs-var">board</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211583"><span class="hs-identifier hs-var">redC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211582"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211581"><span class="hs-identifier hs-var">redSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211580"><span class="hs-identifier hs-var">blueC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211579"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211576"><span class="hs-identifier hs-var">newBlueSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211577"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span id="local-6989586621679211575"><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211575"><span class="hs-identifier hs-var">board</span></a></span></span><span> </span><span id="local-6989586621679211574"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211574"><span class="hs-identifier hs-var">redC</span></a></span></span><span> </span><span id="local-6989586621679211573"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211573"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211572"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211572"><span class="hs-identifier hs-var">redSeed</span></a></span></span><span> </span><span id="local-6989586621679211571"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211571"><span class="hs-identifier hs-var">blueC</span></a></span></span><span> </span><span id="local-6989586621679211570"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211570"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211569"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211569"><span class="hs-identifier hs-var">blueSeed</span></a></span></span><span> </span><span id="local-6989586621679211568"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211568"><span class="hs-identifier hs-var">speed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SpeedChanged"><span class="hs-identifier hs-type">SpeedChanged</span></a></span><span> </span><span id="local-6989586621679211567"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211567"><span class="hs-identifier hs-var">newSpeed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-471"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting
-&gt; Bool -&gt; Int -&gt; Int -&gt; Bool -&gt; Int -&gt; Int -&gt; Int -&gt; State
</span><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-var">SettingsWindow</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211575"><span class="hs-identifier hs-var">board</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211574"><span class="hs-identifier hs-var">redC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211573"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211572"><span class="hs-identifier hs-var">redSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211571"><span class="hs-identifier hs-var">blueC</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211570"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211569"><span class="hs-identifier hs-var">blueSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211567"><span class="hs-identifier hs-var">newSpeed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span class="hs-comment">-- starting game</span><span>
</span><span id="line-473"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span id="local-6989586621679211566"><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211566"><span class="hs-identifier hs-var">boardSetting</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span id="local-6989586621679211565"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211565"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211564"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211564"><span class="hs-identifier hs-var">redSeed</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span id="local-6989586621679211563"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211563"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211562"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211562"><span class="hs-identifier hs-var">blueSeed</span></a></span></span><span> </span><span id="local-6989586621679211561"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211561"><span class="hs-identifier hs-var">speed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="UI.html#StartGame"><span class="hs-identifier hs-var">StartGame</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- both Computers</span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-475"></span><span>        </span><span id="local-6989586621679211560"><span class="annot"><span class="annottext">redHiperparams :: Hiperparameters
</span><a href="#local-6989586621679211560"><span class="hs-identifier hs-var hs-var">redHiperparams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Hiperparameters
</span><a href="GameConstants.html#difficultyToHiperparameters"><span class="hs-identifier hs-var">GameConstants.difficultyToHiperparameters</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211565"><span class="hs-identifier hs-var">redD</span></a></span><span>
</span><span id="line-476"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679211558"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679211558"><span class="hs-identifier hs-var">generatedMove</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679211557"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211557"><span class="hs-identifier hs-var">nextGenerator</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Hiperparameters -&gt; StdGen -&gt; (Maybe Int, StdGen)
</span><a href="AI.html#getNextMove"><span class="hs-identifier hs-var">AI.getNextMove</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting -&gt; GameState
</span><a href="Game.html#newGame"><span class="hs-identifier hs-var">Game.newGame</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211566"><span class="hs-identifier hs-var">boardSetting</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211560"><span class="hs-identifier hs-var">redHiperparams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; StdGen
</span><a href="AI.html#newGenerator"><span class="hs-identifier hs-var">AI.newGenerator</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211564"><span class="hs-identifier hs-var">redSeed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>        </span><span id="local-6989586621679211552"><span class="annot"><span class="annottext">nextMove :: Maybe Event
</span><a href="#local-6989586621679211552"><span class="hs-identifier hs-var hs-var">nextMove</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679211558"><span class="hs-identifier hs-var">generatedMove</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-478"></span><span>            </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Event -&gt; Maybe Event
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Event
</span><a href="UI.html#Error"><span class="hs-identifier hs-var">Error</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Red cannot choose his first move. This shouldn't happen.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679211551"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211551"><span class="hs-identifier hs-var">generatedMoveFromJust</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Event -&gt; Maybe Event
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#MovePlayed"><span class="hs-identifier hs-var">MovePlayed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211551"><span class="hs-identifier hs-var">generatedMoveFromJust</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>        </span><span id="local-6989586621679211550"><span class="annot"><span class="annottext">startingState :: State
</span><a href="#local-6989586621679211550"><span class="hs-identifier hs-var hs-var">startingState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-481"></span><span>            </span><span class="annot"><span class="annottext">GameState -&gt; AISetting -&gt; AISetting -&gt; Int -&gt; Bool -&gt; State
</span><a href="UI.html#ComputerVSComputerWindow"><span class="hs-identifier hs-var">ComputerVSComputerWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting -&gt; GameState
</span><a href="Game.html#newGame"><span class="hs-identifier hs-var">Game.newGame</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211566"><span class="hs-identifier hs-var">boardSetting</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-482"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hiperparameters -&gt; StdGen -&gt; AISetting
</span><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211560"><span class="hs-identifier hs-var">redHiperparams</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211557"><span class="hs-identifier hs-var">nextGenerator</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-483"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hiperparameters -&gt; StdGen -&gt; AISetting
</span><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Hiperparameters
</span><a href="GameConstants.html#difficultyToHiperparameters"><span class="hs-identifier hs-var">GameConstants.difficultyToHiperparameters</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211563"><span class="hs-identifier hs-var">blueD</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; StdGen
</span><a href="AI.html#newGenerator"><span class="hs-identifier hs-var">AI.newGenerator</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211562"><span class="hs-identifier hs-var">blueSeed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-484"></span><span>                </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211561"><span class="hs-identifier hs-var">speed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-486"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; IO (Maybe Event) -&gt; Transition State Event
forall state event.
state -&gt; IO (Maybe event) -&gt; Transition state event
</span><span class="hs-identifier hs-var">Transition</span></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679211550"><span class="hs-identifier hs-var">startingState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Event -&gt; IO (Maybe Event)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Event
</span><a href="#local-6989586621679211552"><span class="hs-identifier hs-var">nextMove</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span id="local-6989586621679211549"><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211549"><span class="hs-identifier hs-var">boardSetting</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="UI.html#StartGame"><span class="hs-identifier hs-var">StartGame</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- both Users</span><span>
</span><span id="line-488"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; State
</span><a href="UI.html#UserVSUserWindow"><span class="hs-identifier hs-var">UserVSUserWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting -&gt; GameState
</span><a href="Game.html#newGame"><span class="hs-identifier hs-var">Game.newGame</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211549"><span class="hs-identifier hs-var">boardSetting</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span id="local-6989586621679211548"><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211548"><span class="hs-identifier hs-var">boardSetting</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span id="local-6989586621679211547"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211547"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211546"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211546"><span class="hs-identifier hs-var">blueSeed</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="UI.html#StartGame"><span class="hs-identifier hs-var">StartGame</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- red User, blue Computer</span><span>
</span><span id="line-490"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span>
</span><span id="line-491"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; AISetting -&gt; State
</span><a href="UI.html#UserVSComputerWindow"><span class="hs-identifier hs-var">UserVSComputerWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting -&gt; GameState
</span><a href="Game.html#newGame"><span class="hs-identifier hs-var">Game.newGame</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211548"><span class="hs-identifier hs-var">boardSetting</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player
</span><a href="Game.html#Blue"><span class="hs-identifier hs-var">Game.Blue</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-492"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hiperparameters -&gt; StdGen -&gt; AISetting
</span><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Hiperparameters
</span><a href="GameConstants.html#difficultyToHiperparameters"><span class="hs-identifier hs-var">GameConstants.difficultyToHiperparameters</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211547"><span class="hs-identifier hs-var">blueD</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; StdGen
</span><a href="AI.html#newGenerator"><span class="hs-identifier hs-var">AI.newGenerator</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211546"><span class="hs-identifier hs-var">blueSeed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span> </span><span id="local-6989586621679211545"><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211545"><span class="hs-identifier hs-var">boardSetting</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span id="local-6989586621679211544"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211544"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211543"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211543"><span class="hs-identifier hs-var">redSeed</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="UI.html#StartGame"><span class="hs-identifier hs-var">StartGame</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- red Computer, blue User</span><span>
</span><span id="line-494"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span>
</span><span id="line-495"></span><span>        </span><span id="local-6989586621679211542"><span class="annot"><span class="annottext">redHiperparams :: Hiperparameters
</span><a href="#local-6989586621679211542"><span class="hs-identifier hs-var hs-var">redHiperparams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Hiperparameters
</span><a href="GameConstants.html#difficultyToHiperparameters"><span class="hs-identifier hs-var">GameConstants.difficultyToHiperparameters</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211544"><span class="hs-identifier hs-var">redD</span></a></span><span>
</span><span id="line-496"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679211541"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679211541"><span class="hs-identifier hs-var">generatedMove</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679211540"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211540"><span class="hs-identifier hs-var">nextGenerator</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Hiperparameters -&gt; StdGen -&gt; (Maybe Int, StdGen)
</span><a href="AI.html#getNextMove"><span class="hs-identifier hs-var">AI.getNextMove</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting -&gt; GameState
</span><a href="Game.html#newGame"><span class="hs-identifier hs-var">Game.newGame</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211545"><span class="hs-identifier hs-var">boardSetting</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211542"><span class="hs-identifier hs-var">redHiperparams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; StdGen
</span><a href="AI.html#newGenerator"><span class="hs-identifier hs-var">AI.newGenerator</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211543"><span class="hs-identifier hs-var">redSeed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>        </span><span id="local-6989586621679211538"><span class="annot"><span class="annottext">nextMove :: Maybe Event
</span><a href="#local-6989586621679211538"><span class="hs-identifier hs-var hs-var">nextMove</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679211541"><span class="hs-identifier hs-var">generatedMove</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-498"></span><span>            </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Event -&gt; Maybe Event
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Event
</span><a href="UI.html#Error"><span class="hs-identifier hs-var">Error</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Red cannot choose his first move. This shouldn't happen.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679211537"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211537"><span class="hs-identifier hs-var">generatedMoveFromJust</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Event -&gt; Maybe Event
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#MovePlayed"><span class="hs-identifier hs-var">MovePlayed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211537"><span class="hs-identifier hs-var">generatedMoveFromJust</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-501"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; IO (Maybe Event) -&gt; Transition State Event
forall state event.
state -&gt; IO (Maybe event) -&gt; Transition state event
</span><span class="hs-identifier hs-var">Transition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; AISetting -&gt; State
</span><a href="UI.html#UserVSComputerWindow"><span class="hs-identifier hs-var">UserVSComputerWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoardSetting -&gt; GameState
</span><a href="Game.html#newGame"><span class="hs-identifier hs-var">Game.newGame</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><a href="#local-6989586621679211545"><span class="hs-identifier hs-var">boardSetting</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player
</span><a href="Game.html#Red"><span class="hs-identifier hs-var">Game.Red</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hiperparameters -&gt; StdGen -&gt; AISetting
</span><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211542"><span class="hs-identifier hs-var">redHiperparams</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211540"><span class="hs-identifier hs-var">nextGenerator</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Event -&gt; IO (Maybe Event)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Event
</span><a href="#local-6989586621679211538"><span class="hs-identifier hs-var">nextMove</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- quitting game</span><span>
</span><span id="line-503"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="UI.html#EndGame"><span class="hs-identifier hs-var">EndGame</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-504"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State
</span><a href="UI.html#defaultSettingsWindow"><span class="hs-identifier hs-var">defaultSettingsWindow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- playing move</span><span>
</span><span id="line-506"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#UserVSUserWindow"><span class="hs-identifier hs-type">UserVSUserWindow</span></a></span><span> </span><span id="local-6989586621679211536"><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211536"><span class="hs-identifier hs-var">gameState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#MovePlayed"><span class="hs-identifier hs-type">MovePlayed</span></a></span><span> </span><span id="local-6989586621679211535"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211535"><span class="hs-identifier hs-var">move</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-507"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Int -&gt; Maybe GameState
</span><a href="Game.html#applyMove"><span class="hs-identifier hs-var">Game.applyMove</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211536"><span class="hs-identifier hs-var">gameState</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211535"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-508"></span><span>        </span><span class="annot"><span class="annottext">Maybe GameState
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; State
</span><a href="UI.html#ErrorWindow"><span class="hs-identifier hs-var">ErrorWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Invalid move played&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679211533"><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211533"><span class="hs-identifier hs-var">nextState</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; State
</span><a href="UI.html#UserVSUserWindow"><span class="hs-identifier hs-var">UserVSUserWindow</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211533"><span class="hs-identifier hs-var">nextState</span></a></span><span class="hs-special">)</span><span>           </span><span>
</span><span id="line-510"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#UserVSComputerWindow"><span class="hs-identifier hs-type">UserVSComputerWindow</span></a></span><span> </span><span id="local-6989586621679211532"><span class="annot"><span class="annottext">gameState :: GameState
</span><a href="#local-6989586621679211532"><span class="hs-identifier hs-var">gameState</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Game.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BoardState
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679211531"><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211531"><span class="hs-identifier hs-var">currentPlayer</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679211530"><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211530"><span class="hs-identifier hs-var">computerColor</span></a></span></span><span> </span><span id="local-6989586621679211529"><span class="annot"><span class="annottext">computerSetting :: AISetting
</span><a href="#local-6989586621679211529"><span class="hs-identifier hs-var">computerSetting</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="UI.html#AISetting"><span class="hs-identifier hs-type">AISetting</span></a></span><span> </span><span id="local-6989586621679211528"><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211528"><span class="hs-identifier hs-var">difficulty</span></a></span></span><span> </span><span id="local-6989586621679211527"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211527"><span class="hs-identifier hs-var">generator</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#MovePlayed"><span class="hs-identifier hs-type">MovePlayed</span></a></span><span> </span><span id="local-6989586621679211526"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211526"><span class="hs-identifier hs-var">move</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211531"><span class="hs-identifier hs-var">currentPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211530"><span class="hs-identifier hs-var">computerColor</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- computer played move</span><span>
</span><span id="line-512"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Int -&gt; Maybe GameState
</span><a href="Game.html#applyMove"><span class="hs-identifier hs-var">Game.applyMove</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211532"><span class="hs-identifier hs-var">gameState</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211526"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-513"></span><span>            </span><span class="annot"><span class="annottext">Maybe GameState
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; State
</span><a href="UI.html#ErrorWindow"><span class="hs-identifier hs-var">ErrorWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Invalid move played&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679211525"><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211525"><span class="hs-identifier hs-var">nextState</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; AISetting -&gt; State
</span><a href="UI.html#UserVSComputerWindow"><span class="hs-identifier hs-var">UserVSComputerWindow</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211525"><span class="hs-identifier hs-var">nextState</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211530"><span class="hs-identifier hs-var">computerColor</span></a></span><span> </span><span class="annot"><span class="annottext">AISetting
</span><a href="#local-6989586621679211529"><span class="hs-identifier hs-var">computerSetting</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- User played move</span><span>
</span><span id="line-516"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Int -&gt; Maybe GameState
</span><a href="Game.html#applyMove"><span class="hs-identifier hs-var">Game.applyMove</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211532"><span class="hs-identifier hs-var">gameState</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211526"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-517"></span><span>            </span><span class="annot"><span class="annottext">Maybe GameState
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; State
</span><a href="UI.html#ErrorWindow"><span class="hs-identifier hs-var">ErrorWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Invalid move played&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679211524"><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211524"><span class="hs-identifier hs-var">nextState</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-519"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span>
</span><span id="line-520"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621679211523"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679211523"><span class="hs-identifier hs-var">generatedMove</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679211522"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211522"><span class="hs-identifier hs-var">nextGenerator</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Hiperparameters -&gt; StdGen -&gt; (Maybe Int, StdGen)
</span><a href="AI.html#getNextMove"><span class="hs-identifier hs-var">AI.getNextMove</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211524"><span class="hs-identifier hs-var">nextState</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211528"><span class="hs-identifier hs-var">difficulty</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211527"><span class="hs-identifier hs-var">generator</span></a></span><span>
</span><span id="line-521"></span><span>                    </span><span id="local-6989586621679211521"><span class="annot"><span class="annottext">nextMove :: Maybe Event
</span><a href="#local-6989586621679211521"><span class="hs-identifier hs-var hs-var">nextMove</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Maybe Player
</span><a href="Game.html#whoWins"><span class="hs-identifier hs-var">Game.whoWins</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211524"><span class="hs-identifier hs-var">nextState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679211523"><span class="hs-identifier hs-var">generatedMove</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-522"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Player
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679211520"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211520"><span class="hs-identifier hs-var">generatedMoveFromJust</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Event -&gt; Maybe Event
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#MovePlayed"><span class="hs-identifier hs-var">MovePlayed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211520"><span class="hs-identifier hs-var">generatedMoveFromJust</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- oponent will play his next move</span><span>
</span><span id="line-523"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Player
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Event
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- there are no possible moves for oponent</span><span>
</span><span id="line-524"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Event
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- if move was winning oponent will not have next move</span><span>
</span><span id="line-525"></span><span>                </span><span class="hs-keyword">in</span><span>
</span><span id="line-526"></span><span>                </span><span class="annot"><span class="annottext">State -&gt; IO (Maybe Event) -&gt; Transition State Event
forall state event.
state -&gt; IO (Maybe event) -&gt; Transition state event
</span><span class="hs-identifier hs-var">Transition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; AISetting -&gt; State
</span><a href="UI.html#UserVSComputerWindow"><span class="hs-identifier hs-var">UserVSComputerWindow</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211524"><span class="hs-identifier hs-var">nextState</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211530"><span class="hs-identifier hs-var">computerColor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hiperparameters -&gt; StdGen -&gt; AISetting
</span><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211528"><span class="hs-identifier hs-var">difficulty</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211522"><span class="hs-identifier hs-var">nextGenerator</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Event -&gt; IO (Maybe Event)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Event
</span><a href="#local-6989586621679211521"><span class="hs-identifier hs-var">nextMove</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span class="hs-comment">-- playing move in computerVSComputerWindow should work only if it is not paused:</span><span>
</span><span id="line-528"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#ComputerVSComputerWindow"><span class="hs-identifier hs-type">ComputerVSComputerWindow</span></a></span><span> </span><span id="local-6989586621679211519"><span class="annot"><span class="annottext">gameState :: GameState
</span><a href="#local-6989586621679211519"><span class="hs-identifier hs-var">gameState</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Game.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BoardState
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679211518"><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211518"><span class="hs-identifier hs-var">currentPlayer</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679211517"><span class="annot"><span class="annottext">redSetting :: AISetting
</span><a href="#local-6989586621679211517"><span class="hs-identifier hs-var">redSetting</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="UI.html#AISetting"><span class="hs-identifier hs-type">AISetting</span></a></span><span> </span><span id="local-6989586621679211516"><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211516"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211515"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211515"><span class="hs-identifier hs-var">redG</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679211514"><span class="annot"><span class="annottext">blueSetting :: AISetting
</span><a href="#local-6989586621679211514"><span class="hs-identifier hs-var">blueSetting</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="UI.html#AISetting"><span class="hs-identifier hs-type">AISetting</span></a></span><span> </span><span id="local-6989586621679211513"><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211513"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211512"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211512"><span class="hs-identifier hs-var">blueG</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679211511"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211511"><span class="hs-identifier hs-var">speed</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#MovePlayed"><span class="hs-identifier hs-type">MovePlayed</span></a></span><span> </span><span id="local-6989586621679211510"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211510"><span class="hs-identifier hs-var">move</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-529"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Int -&gt; Maybe GameState
</span><a href="Game.html#applyMove"><span class="hs-identifier hs-var">Game.applyMove</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211519"><span class="hs-identifier hs-var">gameState</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211510"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-530"></span><span>        </span><span class="annot"><span class="annottext">Maybe GameState
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; State
</span><a href="UI.html#ErrorWindow"><span class="hs-identifier hs-var">ErrorWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Invalid move played&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679211509"><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211509"><span class="hs-identifier hs-var">nextState</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-532"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211518"><span class="hs-identifier hs-var">currentPlayer</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-533"></span><span>                </span><span class="annot"><span class="annottext">Player
</span><a href="Game.html#Red"><span class="hs-identifier hs-var">Game.Red</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-534"></span><span>                    </span><span class="hs-keyword">let</span><span>
</span><span id="line-535"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621679211508"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679211508"><span class="hs-identifier hs-var">generatedMove</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679211507"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211507"><span class="hs-identifier hs-var">nextGenerator</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Hiperparameters -&gt; StdGen -&gt; (Maybe Int, StdGen)
</span><a href="AI.html#getNextMove"><span class="hs-identifier hs-var">AI.getNextMove</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211509"><span class="hs-identifier hs-var">nextState</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211516"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211515"><span class="hs-identifier hs-var">redG</span></a></span><span>
</span><span id="line-536"></span><span>                        </span><span id="local-6989586621679211506"><span class="annot"><span class="annottext">nextMove :: Maybe Event
</span><a href="#local-6989586621679211506"><span class="hs-identifier hs-var hs-var">nextMove</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Maybe Player
</span><a href="Game.html#whoWins"><span class="hs-identifier hs-var">Game.whoWins</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211509"><span class="hs-identifier hs-var">nextState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679211508"><span class="hs-identifier hs-var">generatedMove</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-537"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Player
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679211505"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211505"><span class="hs-identifier hs-var">generatedMoveFromJust</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Event -&gt; Maybe Event
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#MovePlayed"><span class="hs-identifier hs-var">MovePlayed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211505"><span class="hs-identifier hs-var">generatedMoveFromJust</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- oponent will play his next move</span><span>
</span><span id="line-538"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Player
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Event
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- there are no possible moves for oponent</span><span>
</span><span id="line-539"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Event
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- if move was winning oponent will not have next move</span><span>
</span><span id="line-540"></span><span>                        </span><span id="local-6989586621679211504"><span class="annot"><span class="annottext">nextWindow :: State
</span><a href="#local-6989586621679211504"><span class="hs-identifier hs-var hs-var">nextWindow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; AISetting -&gt; AISetting -&gt; Int -&gt; Bool -&gt; State
</span><a href="UI.html#ComputerVSComputerWindow"><span class="hs-identifier hs-var">ComputerVSComputerWindow</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211509"><span class="hs-identifier hs-var">nextState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hiperparameters -&gt; StdGen -&gt; AISetting
</span><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211516"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211507"><span class="hs-identifier hs-var">nextGenerator</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hiperparameters -&gt; StdGen -&gt; AISetting
</span><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211513"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211512"><span class="hs-identifier hs-var">blueG</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211511"><span class="hs-identifier hs-var">speed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-541"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span>
</span><span id="line-542"></span><span>                    </span><span class="annot"><span class="annottext">State -&gt; IO (Maybe Event) -&gt; Transition State Event
forall state event.
state -&gt; IO (Maybe event) -&gt; Transition state event
</span><span class="hs-identifier hs-var">Transition</span></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679211504"><span class="hs-identifier hs-var">nextWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Event -&gt; Int -&gt; IO (Maybe Event)
</span><a href="UI.html#waitAndEvoke"><span class="hs-identifier hs-var">waitAndEvoke</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Event
</span><a href="#local-6989586621679211506"><span class="hs-identifier hs-var">nextMove</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211511"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>                </span><span class="annot"><span class="annottext">Player
</span><a href="Game.html#Blue"><span class="hs-identifier hs-var">Game.Blue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-544"></span><span>                    </span><span class="hs-keyword">let</span><span>
</span><span id="line-545"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621679211503"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679211503"><span class="hs-identifier hs-var">generatedMove</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679211502"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211502"><span class="hs-identifier hs-var">nextGenerator</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Hiperparameters -&gt; StdGen -&gt; (Maybe Int, StdGen)
</span><a href="AI.html#getNextMove"><span class="hs-identifier hs-var">AI.getNextMove</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211509"><span class="hs-identifier hs-var">nextState</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211513"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211512"><span class="hs-identifier hs-var">blueG</span></a></span><span>
</span><span id="line-546"></span><span>                        </span><span id="local-6989586621679211501"><span class="annot"><span class="annottext">nextMove :: Maybe Event
</span><a href="#local-6989586621679211501"><span class="hs-identifier hs-var hs-var">nextMove</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Maybe Player
</span><a href="Game.html#whoWins"><span class="hs-identifier hs-var">Game.whoWins</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211509"><span class="hs-identifier hs-var">nextState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679211503"><span class="hs-identifier hs-var">generatedMove</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-547"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Player
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679211500"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211500"><span class="hs-identifier hs-var">generatedMoveFromJust</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Event -&gt; Maybe Event
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#MovePlayed"><span class="hs-identifier hs-var">MovePlayed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211500"><span class="hs-identifier hs-var">generatedMoveFromJust</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- oponent will play his next move</span><span>
</span><span id="line-548"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Player
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Event
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- there are no possible moves for oponent</span><span>
</span><span id="line-549"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Event
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- if move was winning oponent will not have next move</span><span>
</span><span id="line-550"></span><span>                        </span><span id="local-6989586621679211499"><span class="annot"><span class="annottext">nextWindow :: State
</span><a href="#local-6989586621679211499"><span class="hs-identifier hs-var hs-var">nextWindow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; AISetting -&gt; AISetting -&gt; Int -&gt; Bool -&gt; State
</span><a href="UI.html#ComputerVSComputerWindow"><span class="hs-identifier hs-var">ComputerVSComputerWindow</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211509"><span class="hs-identifier hs-var">nextState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hiperparameters -&gt; StdGen -&gt; AISetting
</span><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211516"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211515"><span class="hs-identifier hs-var">redG</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hiperparameters -&gt; StdGen -&gt; AISetting
</span><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211513"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211502"><span class="hs-identifier hs-var">nextGenerator</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211511"><span class="hs-identifier hs-var">speed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-551"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span>
</span><span id="line-552"></span><span>                    </span><span class="annot"><span class="annottext">State -&gt; IO (Maybe Event) -&gt; Transition State Event
forall state event.
state -&gt; IO (Maybe event) -&gt; Transition state event
</span><span class="hs-identifier hs-var">Transition</span></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679211499"><span class="hs-identifier hs-var">nextWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Event -&gt; Int -&gt; IO (Maybe Event)
</span><a href="UI.html#waitAndEvoke"><span class="hs-identifier hs-var">waitAndEvoke</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Event
</span><a href="#local-6989586621679211501"><span class="hs-identifier hs-var">nextMove</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211511"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span class="hs-comment">-- but, when we pause ComputerVSComputerWindow there can still be one MovePlayed action waiting in the background - we want to ignore it:</span><span>
</span><span id="line-554"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span id="local-6989586621679211498"><span class="annot"><span class="annottext">cvscw :: State
</span><a href="#local-6989586621679211498"><span class="hs-identifier hs-var">cvscw</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="UI.html#ComputerVSComputerWindow"><span class="hs-identifier hs-type">ComputerVSComputerWindow</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AISetting
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AISetting
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#MovePlayed"><span class="hs-identifier hs-type">MovePlayed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679211498"><span class="hs-identifier hs-var">cvscw</span></a></span><span>
</span><span id="line-556"></span><span class="hs-comment">-- also when we go back to main menu from ComputerVSComputerWindow there can still be one MovePlayed action waiting in the background - we want to ignore it:</span><span>
</span><span id="line-557"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span id="local-6989586621679211497"><span class="annot"><span class="annottext">sw :: State
</span><a href="#local-6989586621679211497"><span class="hs-identifier hs-var">sw</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="UI.html#SettingsWindow"><span class="hs-identifier hs-type">SettingsWindow</span></a></span><span class="hs-special">{</span><span id="local-6989586621679211489"><span id="local-6989586621679211490"><span id="local-6989586621679211491"><span id="local-6989586621679211492"><span id="local-6989586621679211493"><span id="local-6989586621679211494"><span id="local-6989586621679211495"><span id="local-6989586621679211496"><span class="annot"><span class="annottext">Bool
Int
BoardSetting
speed :: Int
blueSeed :: Int
blueDifficulty :: Int
isBlueComputer :: Bool
redSeed :: Int
redDifficulty :: Int
isRedComputer :: Bool
boardSetting :: BoardSetting
speed :: State -&gt; Int
blueSeed :: State -&gt; Int
blueDifficulty :: State -&gt; Int
isBlueComputer :: State -&gt; Bool
redSeed :: State -&gt; Int
redDifficulty :: State -&gt; Int
isRedComputer :: State -&gt; Bool
boardSetting :: State -&gt; BoardSetting
</span><a href="#local-6989586621679211489"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#MovePlayed"><span class="hs-identifier hs-type">MovePlayed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-558"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679211497"><span class="hs-identifier hs-var">sw</span></a></span><span>
</span><span id="line-559"></span><span class="hs-comment">-- pausing</span><span>
</span><span id="line-560"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#ComputerVSComputerWindow"><span class="hs-identifier hs-type">ComputerVSComputerWindow</span></a></span><span> </span><span id="local-6989586621679211488"><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211488"><span class="hs-identifier hs-var">gameState</span></a></span></span><span> </span><span id="local-6989586621679211487"><span class="annot"><span class="annottext">AISetting
</span><a href="#local-6989586621679211487"><span class="hs-identifier hs-var">redSetting</span></a></span></span><span> </span><span id="local-6989586621679211486"><span class="annot"><span class="annottext">AISetting
</span><a href="#local-6989586621679211486"><span class="hs-identifier hs-var">blueSetting</span></a></span></span><span> </span><span id="local-6989586621679211485"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211485"><span class="hs-identifier hs-var">speed</span></a></span></span><span> </span><span id="local-6989586621679211484"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211484"><span class="hs-identifier hs-var">paused</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="UI.html#SimulationPaused"><span class="hs-identifier hs-var">SimulationPaused</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-561"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; AISetting -&gt; AISetting -&gt; Int -&gt; Bool -&gt; State
</span><a href="UI.html#ComputerVSComputerWindow"><span class="hs-identifier hs-var">ComputerVSComputerWindow</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211488"><span class="hs-identifier hs-var">gameState</span></a></span><span> </span><span class="annot"><span class="annottext">AISetting
</span><a href="#local-6989586621679211487"><span class="hs-identifier hs-var">redSetting</span></a></span><span> </span><span class="annot"><span class="annottext">AISetting
</span><a href="#local-6989586621679211486"><span class="hs-identifier hs-var">blueSetting</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211485"><span class="hs-identifier hs-var">speed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- resuming</span><span>
</span><span id="line-563"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#ComputerVSComputerWindow"><span class="hs-identifier hs-type">ComputerVSComputerWindow</span></a></span><span> </span><span id="local-6989586621679211483"><span class="annot"><span class="annottext">gameState :: GameState
</span><a href="#local-6989586621679211483"><span class="hs-identifier hs-var">gameState</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Game.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="annot"><span class="annottext">BoardSetting
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BoardState
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679211482"><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211482"><span class="hs-identifier hs-var">currentPlayer</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679211481"><span class="annot"><span class="annottext">redSetting :: AISetting
</span><a href="#local-6989586621679211481"><span class="hs-identifier hs-var">redSetting</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="UI.html#AISetting"><span class="hs-identifier hs-type">AISetting</span></a></span><span> </span><span id="local-6989586621679211480"><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211480"><span class="hs-identifier hs-var">redD</span></a></span></span><span> </span><span id="local-6989586621679211479"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211479"><span class="hs-identifier hs-var">redG</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679211478"><span class="annot"><span class="annottext">blueSetting :: AISetting
</span><a href="#local-6989586621679211478"><span class="hs-identifier hs-var">blueSetting</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="UI.html#AISetting"><span class="hs-identifier hs-type">AISetting</span></a></span><span> </span><span id="local-6989586621679211477"><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211477"><span class="hs-identifier hs-var">blueD</span></a></span></span><span> </span><span id="local-6989586621679211476"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211476"><span class="hs-identifier hs-var">blueG</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679211475"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211475"><span class="hs-identifier hs-var">speed</span></a></span></span><span> </span><span id="local-6989586621679211474"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679211474"><span class="hs-identifier hs-var">paused</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="UI.html#SimulationResumed"><span class="hs-identifier hs-var">SimulationResumed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679211482"><span class="hs-identifier hs-var">currentPlayer</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-565"></span><span>        </span><span class="annot"><span class="annottext">Player
</span><a href="Game.html#Red"><span class="hs-identifier hs-var">Game.Red</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-566"></span><span>            </span><span class="hs-keyword">let</span><span>
</span><span id="line-567"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679211473"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679211473"><span class="hs-identifier hs-var">generatedMove</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679211472"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211472"><span class="hs-identifier hs-var">nextGenerator</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Hiperparameters -&gt; StdGen -&gt; (Maybe Int, StdGen)
</span><a href="AI.html#getNextMove"><span class="hs-identifier hs-var">AI.getNextMove</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211483"><span class="hs-identifier hs-var">gameState</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211480"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211479"><span class="hs-identifier hs-var">redG</span></a></span><span>
</span><span id="line-568"></span><span>                </span><span id="local-6989586621679211471"><span class="annot"><span class="annottext">nextMove :: Maybe Event
</span><a href="#local-6989586621679211471"><span class="hs-identifier hs-var hs-var">nextMove</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Maybe Player
</span><a href="Game.html#whoWins"><span class="hs-identifier hs-var">Game.whoWins</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211483"><span class="hs-identifier hs-var">gameState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679211473"><span class="hs-identifier hs-var">generatedMove</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-569"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Player
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679211470"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211470"><span class="hs-identifier hs-var">generatedMoveFromJust</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Event -&gt; Maybe Event
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#MovePlayed"><span class="hs-identifier hs-var">MovePlayed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211470"><span class="hs-identifier hs-var">generatedMoveFromJust</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- oponent will play his next move</span><span>
</span><span id="line-570"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Player
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Event
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- there are no possible moves for oponent</span><span>
</span><span id="line-571"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Event
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- if move was winning oponent will not have next move</span><span>
</span><span id="line-572"></span><span>                </span><span id="local-6989586621679211469"><span class="annot"><span class="annottext">nextWindow :: State
</span><a href="#local-6989586621679211469"><span class="hs-identifier hs-var hs-var">nextWindow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; AISetting -&gt; AISetting -&gt; Int -&gt; Bool -&gt; State
</span><a href="UI.html#ComputerVSComputerWindow"><span class="hs-identifier hs-var">ComputerVSComputerWindow</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211483"><span class="hs-identifier hs-var">gameState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hiperparameters -&gt; StdGen -&gt; AISetting
</span><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211480"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211472"><span class="hs-identifier hs-var">nextGenerator</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hiperparameters -&gt; StdGen -&gt; AISetting
</span><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211477"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211476"><span class="hs-identifier hs-var">blueG</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211475"><span class="hs-identifier hs-var">speed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-573"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span>
</span><span id="line-574"></span><span>            </span><span class="annot"><span class="annottext">State -&gt; IO (Maybe Event) -&gt; Transition State Event
forall state event.
state -&gt; IO (Maybe event) -&gt; Transition state event
</span><span class="hs-identifier hs-var">Transition</span></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679211469"><span class="hs-identifier hs-var">nextWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Event -&gt; Int -&gt; IO (Maybe Event)
</span><a href="UI.html#waitAndEvoke"><span class="hs-identifier hs-var">waitAndEvoke</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Event
</span><a href="#local-6989586621679211471"><span class="hs-identifier hs-var">nextMove</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211475"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>        </span><span class="annot"><span class="annottext">Player
</span><a href="Game.html#Blue"><span class="hs-identifier hs-var">Game.Blue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-576"></span><span>            </span><span class="hs-keyword">let</span><span>
</span><span id="line-577"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679211468"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679211468"><span class="hs-identifier hs-var">generatedMove</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679211467"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211467"><span class="hs-identifier hs-var">nextGenerator</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Hiperparameters -&gt; StdGen -&gt; (Maybe Int, StdGen)
</span><a href="AI.html#getNextMove"><span class="hs-identifier hs-var">AI.getNextMove</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211483"><span class="hs-identifier hs-var">gameState</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211477"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211476"><span class="hs-identifier hs-var">blueG</span></a></span><span>
</span><span id="line-578"></span><span>                </span><span id="local-6989586621679211466"><span class="annot"><span class="annottext">nextMove :: Maybe Event
</span><a href="#local-6989586621679211466"><span class="hs-identifier hs-var hs-var">nextMove</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Maybe Player
</span><a href="Game.html#whoWins"><span class="hs-identifier hs-var">Game.whoWins</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211483"><span class="hs-identifier hs-var">gameState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679211468"><span class="hs-identifier hs-var">generatedMove</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-579"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Player
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679211465"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211465"><span class="hs-identifier hs-var">generatedMoveFromJust</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Event -&gt; Maybe Event
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Event
</span><a href="UI.html#MovePlayed"><span class="hs-identifier hs-var">MovePlayed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211465"><span class="hs-identifier hs-var">generatedMoveFromJust</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- oponent will play his next move</span><span>
</span><span id="line-580"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Player
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Event
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- there are no possible moves for oponent</span><span>
</span><span id="line-581"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Event
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- if move was winning oponent will not have next move</span><span>
</span><span id="line-582"></span><span>                </span><span id="local-6989586621679211464"><span class="annot"><span class="annottext">nextWindow :: State
</span><a href="#local-6989586621679211464"><span class="hs-identifier hs-var hs-var">nextWindow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; AISetting -&gt; AISetting -&gt; Int -&gt; Bool -&gt; State
</span><a href="UI.html#ComputerVSComputerWindow"><span class="hs-identifier hs-var">ComputerVSComputerWindow</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679211483"><span class="hs-identifier hs-var">gameState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hiperparameters -&gt; StdGen -&gt; AISetting
</span><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211480"><span class="hs-identifier hs-var">redD</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211479"><span class="hs-identifier hs-var">redG</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hiperparameters -&gt; StdGen -&gt; AISetting
</span><a href="UI.html#AISetting"><span class="hs-identifier hs-var">AISetting</span></a></span><span> </span><span class="annot"><span class="annottext">Hiperparameters
</span><a href="#local-6989586621679211477"><span class="hs-identifier hs-var">blueD</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679211467"><span class="hs-identifier hs-var">nextGenerator</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211475"><span class="hs-identifier hs-var">speed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-583"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span>
</span><span id="line-584"></span><span>            </span><span class="annot"><span class="annottext">State -&gt; IO (Maybe Event) -&gt; Transition State Event
forall state event.
state -&gt; IO (Maybe event) -&gt; Transition state event
</span><span class="hs-identifier hs-var">Transition</span></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679211464"><span class="hs-identifier hs-var">nextWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Event -&gt; Int -&gt; IO (Maybe Event)
</span><a href="UI.html#waitAndEvoke"><span class="hs-identifier hs-var">waitAndEvoke</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Event
</span><a href="#local-6989586621679211466"><span class="hs-identifier hs-var">nextMove</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679211475"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span class="hs-comment">--- errors</span><span>
</span><span id="line-586"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UI.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span id="local-6989586621679211463"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679211463"><span class="hs-identifier hs-var">text</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-587"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; State
</span><a href="UI.html#ErrorWindow"><span class="hs-identifier hs-var">ErrorWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679211463"><span class="hs-identifier hs-var">text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span class="hs-comment">--- actions that shouldn't appear</span><span>
</span><span id="line-589"></span><span class="annot"><a href="UI.html#update%27"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-590"></span><span>    </span><span class="annot"><span class="annottext">State -&gt; Transition State Event
</span><a href="UI.html#simpleTrans"><span class="hs-identifier hs-var">simpleTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; State
</span><a href="UI.html#ErrorWindow"><span class="hs-identifier hs-var">ErrorWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;This shouldn't happen.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span class="hs-comment">-- | Initial state of the application. </span><span>
</span><span id="line-594"></span><span class="hs-comment">--   Application starts with the SettingsWindow.</span><span>
</span><span id="line-595"></span><span class="annot"><a href="UI.html#initialState%27"><span class="hs-identifier hs-type">initialState'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UI.html#State"><span class="hs-identifier hs-type">State</span></a></span><span>
</span><span id="line-596"></span><span id="initialState%27"><span class="annot"><span class="annottext">initialState' :: State
</span><a href="UI.html#initialState%27"><span class="hs-identifier hs-var hs-var">initialState'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State
</span><a href="UI.html#defaultSettingsWindow"><span class="hs-identifier hs-var">defaultSettingsWindow</span></a></span><span>
</span><span id="line-597"></span></pre></body></html>